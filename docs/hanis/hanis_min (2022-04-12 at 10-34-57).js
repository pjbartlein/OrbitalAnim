var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(c){var f=0;return function(){return f<c.length?{done:!1,value:c[f++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.makeIterator=function(c){var f="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];return f?f.call(c):$jscomp.arrayIterator(c)};
$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var f=0;f<c.length;++f){var h=c[f];if(h&&h.Math==Math)return h}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,h){c!=Array.prototype&&c!=Object.prototype&&(c[f]=h.value)};$jscomp.polyfill=function(c,f,h,q){if(f){h=$jscomp.global;c=c.split(".");for(q=0;q<c.length-1;q++){var E=c[q];E in h||(h[E]={});h=h[E]}c=c[c.length-1];q=h[c];f=f(q);f!=q&&null!=f&&$jscomp.defineProperty(h,c,{configurable:!0,writable:!0,value:f})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function f(){this.batch_=null}function h(c){return c instanceof E?c:new E(function(f,wc){f(c)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;f.prototype.asyncExecute=function(c){if(null==this.batch_){this.batch_=[];var f=this;this.asyncExecuteFunction(function(){f.executeBatch_()})}this.batch_.push(c)};var q=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(c){q(c,0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var c=
this.batch_;this.batch_=[];for(var f=0;f<c.length;++f){var h=c[f];c[f]=null;try{h()}catch(ma){this.asyncThrow_(ma)}}}this.batch_=null};f.prototype.asyncThrow_=function(c){this.asyncExecuteFunction(function(){throw c;})};var E=function(c){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var f=this.createResolveAndReject_();try{c(f.resolve,f.reject)}catch(kb){f.reject(kb)}};E.prototype.createResolveAndReject_=function(){function c(c){return function(wc){h||(h=!0,c.call(f,wc))}}var f=this,
h=!1;return{resolve:c(this.resolveTo_),reject:c(this.reject_)}};E.prototype.resolveTo_=function(c){if(c===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof E)this.settleSameAsPromise_(c);else{a:switch(typeof c){case "object":var f=null!=c;break a;case "function":f=!0;break a;default:f=!1}f?this.resolveToNonPromiseObj_(c):this.fulfill_(c)}};E.prototype.resolveToNonPromiseObj_=function(c){var f=void 0;try{f=c.then}catch(kb){this.reject_(kb);return}"function"==
typeof f?this.settleSameAsThenable_(f,c):this.fulfill_(c)};E.prototype.reject_=function(c){this.settle_(2,c)};E.prototype.fulfill_=function(c){this.settle_(1,c)};E.prototype.settle_=function(c,f){if(0!=this.state_)throw Error("Cannot settle("+c+", "+f+"): Promise already settled in state"+this.state_);this.state_=c;this.result_=f;this.executeOnSettledCallbacks_()};E.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var c=0;c<this.onSettledCallbacks_.length;++c)Gb.asyncExecute(this.onSettledCallbacks_[c]);
this.onSettledCallbacks_=null}};var Gb=new f;E.prototype.settleSameAsPromise_=function(c){var f=this.createResolveAndReject_();c.callWhenSettled_(f.resolve,f.reject)};E.prototype.settleSameAsThenable_=function(c,f){var h=this.createResolveAndReject_();try{c.call(f,h.resolve,h.reject)}catch(ma){h.reject(ma)}};E.prototype.then=function(c,f){function h(c,f){return"function"==typeof c?function(f){try{q(c(f))}catch(Hb){aa(Hb)}}:f}var q,aa,wc=new E(function(c,f){q=c;aa=f});this.callWhenSettled_(h(c,q),
h(f,aa));return wc};E.prototype.catch=function(c){return this.then(void 0,c)};E.prototype.callWhenSettled_=function(c,f){function h(){switch(q.state_){case 1:c(q.result_);break;case 2:f(q.result_);break;default:throw Error("Unexpected state: "+q.state_);}}var q=this;null==this.onSettledCallbacks_?Gb.asyncExecute(h):this.onSettledCallbacks_.push(h)};E.resolve=h;E.reject=function(c){return new E(function(f,h){h(c)})};E.race=function(c){return new E(function(f,q){for(var E=$jscomp.makeIterator(c),aa=
E.next();!aa.done;aa=E.next())h(aa.value).callWhenSettled_(f,q)})};E.all=function(c){var f=$jscomp.makeIterator(c),q=f.next();return q.done?h([]):new E(function(c,E){function aa(f){return function(h){ma[f]=h;Na--;0==Na&&c(ma)}}var ma=[],Na=0;do ma.push(void 0),Na++,h(q.value).callWhenSettled_(aa(ma.length-1),E),q=f.next();while(!q.done)})};return E},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(c,f){this.$jscomp$symbol$id_=c;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function c(h){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(h||"")+"_"+f++,h)}var f=0;return c}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.underscoreProtoCanBeSet=function(){var c={a:!0},f={};try{return f.__proto__=c,f.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(c,f){c.__proto__=f;if(c.__proto__!==f)throw new TypeError(c+" is not extensible");return c}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(c){if(!(c instanceof Object))throw new TypeError("Iterator result "+c+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(c){this.yieldResult=c};$jscomp.generator.Context.prototype.throw_=function(c){this.abruptCompletion_={exception:c,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(c){this.abruptCompletion_={return:c};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(c){this.abruptCompletion_={jumpTo:c};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(c,f){this.nextAddress=f;return{value:c}};$jscomp.generator.Context.prototype.yieldAll=function(c,f){c=$jscomp.makeIterator(c);var h=c.next();$jscomp.generator.ensureIteratorResultIsObject_(h);if(h.done)this.yieldResult=h.value,this.nextAddress=f;else return this.yieldAllIterator_=c,this.yield(h.value,f)};
$jscomp.generator.Context.prototype.jumpTo=function(c){this.nextAddress=c};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(c,f){this.catchAddress_=c;void 0!=f&&(this.finallyAddress_=f)};$jscomp.generator.Context.prototype.setFinallyBlock=function(c){this.catchAddress_=0;this.finallyAddress_=c||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(c,f){this.nextAddress=c;this.catchAddress_=f||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(c){this.catchAddress_=c||0;c=this.abruptCompletion_.exception;this.abruptCompletion_=null;return c};$jscomp.generator.Context.prototype.enterFinallyBlock=function(c,f,h){h?this.finallyContexts_[h]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=c||0;this.finallyAddress_=f||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(c,f){f=this.finallyContexts_.splice(f||0)[0];if(f=this.abruptCompletion_=this.abruptCompletion_||f){if(f.isException)return this.jumpToErrorHandler_();void 0!=f.jumpTo&&this.finallyAddress_<f.jumpTo?(this.nextAddress=f.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=c};$jscomp.generator.Context.prototype.forIn=function(c){return new $jscomp.generator.Context.PropertyIterator(c)};
$jscomp.generator.Context.PropertyIterator=function(c){this.object_=c;this.properties_=[];for(var f in c)this.properties_.push(f);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var c=this.properties_.pop();if(c in this.object_)return c}return null};$jscomp.generator.Engine_=function(c){this.context_=new $jscomp.generator.Context;this.program_=c};
$jscomp.generator.Engine_.prototype.next_=function(c){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,c,this.context_.next_);this.context_.next_(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(c){this.context_.start_();var f=this.context_.yieldAllIterator_;if(f)return this.yieldAllStep_("return"in f?f["return"]:function(c){return{value:c,done:!0}},c,this.context_.return);this.context_.return(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(c){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],c,this.context_.next_);this.context_.throw_(c);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(c,f,h){try{var q=c.call(this.context_.yieldAllIterator_,f);$jscomp.generator.ensureIteratorResultIsObject_(q);if(!q.done)return this.context_.stop_(),q;var E=q.value}catch(Gb){return this.context_.yieldAllIterator_=null,this.context_.throw_(Gb),this.nextStep_()}this.context_.yieldAllIterator_=null;h.call(this.context_,E);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var c=this.program_(this.context_);if(c)return this.context_.stop_(),{value:c.value,done:!1}}catch(f){this.context_.yieldResult=void 0,this.context_.throw_(f)}this.context_.stop_();if(this.context_.abruptCompletion_){c=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(c.isException)throw c.exception;return{value:c.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(c){this.next=function(f){return c.next_(f)};this.throw=function(f){return c.throw_(f)};this.return=function(f){return c.return_(f)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(c,f){f=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(f));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(f,c.prototype);return f};
$jscomp.asyncExecutePromiseGenerator=function(c){function f(f){return c.next(f)}function h(f){return c.throw(f)}return new Promise(function(q,E){function Gb(c){c.done?q(c.value):Promise.resolve(c.value).then(f,h).then(Gb,E)}Gb(c.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(c){return $jscomp.asyncExecutePromiseGenerator(c())};$jscomp.asyncExecutePromiseGeneratorProgram=function(c){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c)))};
$jscomp.iteratorFromArray=function(c,f){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var h=0,q={next:function(){if(h<c.length){var E=h++;return{value:f(E,c[E]),done:!1}}q.next=function(){return{done:!0,value:void 0}};return q.next()}};q[Symbol.iterator]=function(){return q};return q};
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(c,h,q){var f=this.length||0;0>h&&(h=Math.max(0,f+h));if(null==q||q>f)q=f;q=Number(q);0>q&&(q=Math.max(0,f+q));for(h=Number(h||0);h<q;h++)this[h]=c;return this}},"es6","es3");
function PEvs(c,f,h,q,E,Gb,wc){var aa,kb,ma,Ke,qd,Pf,Na,Wb,Hb,ea,lb,Ib=0,Xb=0,Yd,Oa=!1,xc=!1,Yb=0,mb=0,Zb=0,qb=0,rd,Mc,Zd=3,$b=function(c){Na=c.target;for(Hb=Wb=0;Na;)Wb+=Na.offsetLeft-Na.scrollLeft,Hb+=Na.offsetTop-Na.scrollTop,Na=Na.offsetParent;Ib=(Oa?rd:c.pageX)-Wb-document.body.scrollLeft;Xb=(Oa?Mc:c.pageY)-Hb-document.body.scrollTop};this.getX=function(){return Ib};this.getY=function(){return Xb};this.setHysteresis=function(c){Zd=c};var F=function(c){c.preventDefault();c.stopImmediatePropagation?
c.stopImmediatePropagation():c.stopPropagation()},$d=function(c){$b(c);Yd=Ib;wa=Xb;U=!0;null!=fa&&(Ke=(new Date).getTime());null!=na&&na(c)},L=function(c){U&&($b(c),U=!1,null!=rb&&rb(c),null!=fa&&(qd=(new Date).getTime(),Pf=qd-Ke,300>Pf&&fa(c)))},Ja=function(c){$b(c);Math.abs(Ib-Yd)<Zd&&Math.abs(Xb-wa)<Zd||(wa=Yd=-9999,U?null!=Va&&Va(c):null!=nb&&nb(c),null!=ae&&Le())};this.touchDown=function(c){ma=!0;if(1<c.targetTouches.length)return Oa=!0,lb&&(mb=-1,F(c)),!1;aa=c.changedTouches;kb=aa[0];$d(kb)};
this.touchUp=function(c){0==c.targetTouches.length&&(Oa=ma=!1);F(c);if(Oa||xc)return Oa||(xc=!1),!1;aa=c.changedTouches;kb=aa[0];L(kb)};this.touchMove=function(c){ma=!0;F(c);if(Oa)return lb&&(aa=c.targetTouches,rd=(aa[0].pageX+aa[1].pageX)/2,Mc=(aa[0].pageY+aa[1].pageY)/2,xc=!0,Zb=aa[0].pageX-aa[1].pageX,qb=aa[0].pageY-aa[1].pageY,Yb=Zb*Zb+qb*qb,$b(c),lb&&0<mb&&30<Math.abs(Yb-mb)&&lb(0<Yb-mb?1:-1),mb=Yb),!1;aa=c.changedTouches;kb=aa[0];Ja(kb)};this.pointUp=function(c){F(c);for(var f=0;f<xa.length;f++)if(xa[f].pointerId==
c.pointerId){xa.splice(f,1);break}0==xa.length&&(ma=Oa=!1);if(Oa||xc)return Oa||(xc=!1),!1;L(c);return!1};this.pointDown=function(c){F(c);xa.push(c);mb=-1;ma=!0;1<xa.length?Oa=!0:$d(c);return!1};this.pointMove=function(c){F(c);for(var f=0;f<xa.length;f++)xa[f].pointerId==c.pointerId&&(xa[f]=c);if(Oa||!xc){if(Oa)return rd=(xa[0].pageX+xa[1].pageX)/2,Mc=(xa[0].pageY+xa[1].pageY)/2,$b(c),lb&&(xc=!0,Zb=xa[0].pageX-xa[1].pageX,qb=xa[0].pageY-xa[1].pageY,Yb=Zb*Zb+qb*qb,lb&&0<mb&&30<Math.abs(Yb-mb)&&lb(0<
Yb-mb?1:-1),mb=Yb),!1;Ja(c);return!1}};this.mouseDown=function(c){ma||(F(c),$d(c))};this.clearDown=function(){U=!1};this.mouseUp=function(c){ma||(F(c),L(c))};this.useWheel=function(f){c.addEventListener("wheel",this.mouseWheel,!0);lb=f};this.mouseWheel=function(c){$b(c);var f=Math.max(-1,Math.min(1,-c.deltaY||-c.detail));F(c);lb&&lb(f)};this.mouseClick=function(c){F(c);U=!1};this.mouseMove=function(c){ma||(F(c),Ja(c))};this.mouseDragged=function(c){ma||(F(c),$b(c),null!=Va&&Va(c),null!=ae&&Le())};
var Le=function(){clearTimeout(ea);ea=setTimeout(function(){ae()},600)};var wa=Yd=Xb=Ib=0;var na=f;var rb=h;var nb=q;var Va=E;var fa=Gb;var ae=wc;var U=ma=!1;var xa=[];c.addEventListener("mousedown",this.mouseDown,!1);c.addEventListener("mouseup",this.mouseUp,!1);c.addEventListener("mousemove",this.mouseMove,!1);c.addEventListener("click",this.mouseClick,!1);c.addEventListener("touchstart",this.touchDown,!1);c.addEventListener("touchend",this.touchUp,!1);c.addEventListener("touchmove",this.touchMove,
!1);c.addEventListener("touchleave",this.touchUp,!1);c.addEventListener("touchcancel",this.touchUp,!1);c.addEventListener("contextmenu",function(c){c.preventDefault()},!1);c.style["touch-action"]="none";c.addEventListener("mouseout",function(c){U||(Xb=Ib=-1,null!=nb&&nb(c));U=!1})};var HAniS=new function(){function c(b){var a,g;sd=!0;if(b instanceof Array)for(e={},null!=gh&&(b=b.concat(gh)),a=0;a<b.length;a++){if(!(2>b[a].length)){var d=b[a].trim();if(0!=d.indexOf("#")){var c=d.indexOf("=");if(!(1>c)){var S=d.substr(0,c).trim().toLowerCase();e[S]=d.substr(c+1).trim()}}}}else e=b;Me=!1;a=e.debug;null!=a&&("true"==a?(Qf=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),Me=!0,ha("HAniS Version 4.43")):Me=!1);a=e.no_initial_focus;null!=a&&"false"!=a||u.focus();
ob=!0;z(e.set_className,"f")&&(ob=!1);ha("Is type of param an array = "+(b instanceof Array));a=e.divalign;null!=a&&(be=a.trim(),u.align=be);z(e.prevent_shortcuts,"t")&&(Ne=!0);a=e.initial_message;null!=a&&(b=e.initial_message_style,null==b&&(b="background-color:red;top:10px;left:10px;height:100px;width:200px"),b="z-index:99;position:absolute;"+b,yc=p("div"),yc.setAttribute("style",b),yc.innerHTML=a,yc.addEventListener("click",function(){yc.style.visibility="hidden"},!1),yc.style.visibility="visible",
Wa.appendChild(yc),b=e.initial_message_timeout,null!=b&&("auto"==b?Rf=!0:(Rf=!1,b=parseInt(e.initial_message_timeout,10),2>b&&(b=2),setTimeout(function(){yc.style.visibility="hidden"},1E3*b))));td=null;a=e.initial_enhancement;null!=a&&(td=parseInt(a,10)-1);ud=!1;Oe="X = ";Pe=" Y = ";a=e.coordinates;null!=a&&(E(a),ud=!0,Oe="Lat = ",Pe=" Lon = ");d="green";c="white";S="12px Arial";var Q=null,l=g=10,k=10;Sf=2;a=e.keyboard_propagate;null!=a&&z(a,"t")&&(Qe=!1);a=e.coordinates_display_style;null!=a&&(b=
a.split(","),d=b[0].trim(),c=b[1].trim(),S=b[2].trim(),3<b.length&&(Oe=b[3],Pe=b[4],Sf=parseInt(b[5],10),6<b.length&&(Q=b[6].trim(),g=parseInt(b[7],10),l=parseInt(b[8],10),k=parseInt(b[9],10))));hh=new nb(d,c,S,Q,g,l,k);Re=Oc=null;null!=e.map_scale&&(Se=ac=!0,b=e.map_scale.split(","),Oc=parseFloat(b[0]),Re=1<b.length?parseFloat(b[1]):Oc);vd=ud?"km":" ";Te=1;a=e.distance_unit;null!=a&&(vd=a.trim(),z(vd,"mi")&&(Te=.621371192),z(vd,"nm")&&(Te=.539956803),z(vd,"na")&&(Te=.539956803));ce=null;a=e.show_bearing;
null!=a&&(ce=a.trim());a=e.divcan_style;null!=a&&a.trim();Tf="default";a=e.distance_cursor;null!=a&&(Tf=a.trim());Ue="default";a=e.location_cursor;null!=a&&(Ue=a.trim());Ve="default";a=e.probe_cursor;null!=a&&(Ve=a.trim());Uf="default";a=e.mark_cursor;null!=a&&(Uf=a.trim());a=e.imagecan_style;null!=a&&(b=a.trim()+";position:absolute;top:0;left:0;",sb.setAttribute("style",b+"z-index:1;"),zc.setAttribute("style",b+"z-index:12;"));d="blue";c="white";S="12px Arial";Q=null;k=l=g=10;Vf=1;ih="white";a=e.distance_display_style;
null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),ih=5<=b.length?b[4].trim():c,S=b[2].trim(),Vf=parseInt(b[3],10),5<b.length&&(Q=b[5].trim(),g=parseInt(b[6],10),l=parseInt(b[7],10),k=parseInt(b[8],10)));Fi=new nb(d,c,S,Q,g,l,k);d="black";c="white";S="12px Arial";Q=null;k=l=g=10;a=e.probe_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),S=b[2].trim(),3<b.length&&(Q=b[3].trim(),g=parseInt(b[4],10),l=parseInt(b[5],10),k=parseInt(b[6],10)));Gi=new nb(d,c,S,Q,g,l,k);jh="Undefined";
kh=!1;de=0;a=e.probe_undefined;null!=a&&(b=a.split(","),jh=b[0].trim(),1<b.length&&(de=parseInt(b[1],10)+1),2<b.length&&(kh=!0));Wf=!1;e.probe_base_image&&(Wf=!0);a=e.active_probe;null!=a&&(bc=!0);a=e.pause;null!=a&&(lh=parseInt(a,10));a=e.auto_refresh;null!=a&&(Xf=6E4*parseInt(a,10),Pc=setInterval("HAniS.reloadFOF();",Xf),ee=!0);We=!1;mh="#FFFFFF80";a=e.show_hotspots;null!=a&&(b=a.split(","),z(b[0],"t")&&(We=!0),1<b.length&&(mh=b[1]));Yf=!1;z(e.center_hotspots,"t")&&(Yf=!0);wd=!1;z(e.enable_smoothing,
"t")&&(wd=!0);nh="low";a=e.smoothing_quality;null!=a&&(nh=a);Xe=!0;z(e.check_image_size,"f")&&(Xe=!1);oh=!1;a=e.sprites;if(null!=a){b=a.split(",");Zf=new Image;$f=[];ag=[];cc=[];dc=[];if("row"==b[1].trim().toLowerCase())for(l=c=d=0,a=2;a<b.length;)for("row"==b[a].trim().toLowerCase()&&(d=0,c+=l,l=0,a+=1),g=parseInt(b[a],10),a+=1,S=parseInt(b[a],10),a+=1,Q=parseInt(b[a],10),Q>l&&(l=Q),a+=1,k=0;k<g;k++)$f.push(d),ag.push(c),cc.push(S),dc.push(Q),d+=S;else for(c=!1,a=1;a<b.length;)$f.push(parseInt(b[a],
10)),a+=1,ag.push(parseInt(b[a],10)),a+=1,a>=b.length?(d=0,c=!0):d=parseInt(b[a],10),0>d?(c=!0,cc.push(Math.abs(d)),a+=1,d=parseInt(b[a++],10),dc.push(Math.abs(d))):c?(cc.push(cc[cc.length-1]),dc.push(dc[dc.length-1])):(cc.push(parseInt(b[a],10)),a+=1,dc.push(parseInt(b[a],10)),a+=1);Zf.onload=function(){oh=!0};Zf.src=b[0]}a=e.overlay_labels;null!=a&&(ec=a.split(","));bg=null;a=e.auto_enhance_background;null!=a&&(bg=parseInt(a,10)-1);Qc=null;a=e.auto_enhance;if(null!=a)for(d=e.overlay_probe_table,
b=a.split(","),Qc=Array(b.length),a=0;a<b.length;a++)"x"==b[a].trim().toLowerCase()?Qc[a]=-1:Qc[a]=parseInt(b[a].trim(),10)-1,null==d&&(Ac[a]=Qc[a]);Rc=!1;tb=-1;a=e.overlay_enhance;null!=a&&(Rc=!0,tb=parseInt(a,10)-1);Bc=null;xd=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(b=a.split(","),Bc=Array(b.length),a=0;a<b.length;a++)if(Bc[a]=!0,z(b[a],"n")||z(b[a],"f"))Bc[a]=!1;M=P=null;fe=ph=!1;a=e.window_size;null!=a&&(b=a.split(","),"div"==b[0]?fe=!0:(M=2*Math.floor(parseInt(b[0],10)/2),P=2*Math.floor(parseInt(b[1],
10)/2)),ph=!0);cg=[];a=e.framenumber_index_values;null!=a&&(cg=a.split(","));Jb=[];a=e.use_for_all_frames;if(null!=a)for(b=a.split(","),a=0;a<b.length;a+=2)Jb[parseInt(b[a],10)]=parseInt(b[a+1],10)-1;ge=-1;a=e.skip_missing;null!=a&&(ge=parseInt(a,10));qh="#00000000";a=e.skip_missing_color;null!=a&&(qh=a);Ye=null;a=e.overlay_spacer;if(null!=a)for(b=a.split(","),Ye=Array(b.length),a=0;a<b.length;a++)Ye[a]=parseInt(b[a],10);a=e.overlay_probe_table;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)"x"==
b[a].trim().toLowerCase()?Ac[a]=-1:Ac[a]=parseInt(b[a],10)-1;dg=[];a=e.overlay_ontop;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)dg[parseInt(b[a],10)-1]=!0;Sc=null;a=e.overlay_order;null==a&&(a=e.overlay_zorder);if(null!=a)for(b=a.split(","),Sc=Array(b.length),a=0;a<b.length;a++)Sc[parseInt(b[a],10)-1]=a;fc=null;a=e.overlay_links;if(null!=a)for(b=a.split(","),fc=Array(b.length),a=0;a<b.length;a++)fc[a]=parseInt(b[a],10);rh=[];V=null;a=e.overlay_slice;if(null!=a)for(b=a.split(","),a=0;a<b.length;a++)rh[parseInt(b[a],
10)-1]=!0;sh=!0;z(e.slice_smoothing,"f")&&(sh=!1);yd=null;a=e.overlay_clear;if(null!=a)for(b=a.split(","),yd=Array(b.length),a=0;a<b.length;a++)yd[a]=b[a].trim().toLowerCase();th=!1;a=e.transparency;null!=a&&(b=a.split(","),1==b.length?uh=vh=wh=parseInt(b[0],10):(uh=parseInt(b[0],10),vh=parseInt(b[1],10),wh=parseInt(b[2],10)),th=!0);eg=!1;a=e.transparency_list;if(null!=a){b=a.split(",");xh=[];for(a=0;a<b.length;a++)xh[parseInt(b[a].trim(),10)-1]=!0;eg=!0}Ze=null;a=e.overlay_transparent_amount;if(null!=
a)for(b=a.split(","),Ze=Array(b.length),a=0;a<b.length;a++)Ze[a]=parseFloat(b[a])/100;Tc=null;a=e.overlay_zoom;if(null!=ec&&null!=a)for(b=a.split(","),Tc=Array(b.length),a=0;a<b.length;a++)if(Tc[a]=1,z(b[a],"n")||z(b[a],"f"))Tc[a]=0;else if(z(b[a],"d")||z(b[a],"h"))Tc[a]=-1;ub=null;yh=[];a=e.overlay_preserve_list;if(null!=ec&&null!=a)for(b=a.split(","),ub=Array(b.length),a=0;a<b.length;a++){ub[a]=!0;if(z(b[a],"n")||z(b[a],"f"))ub[a]=!1;if(z(b[a],"a")||z(b[a],"A"))yh[a]=!0}la=null;if(null!=ec&&null!=
ub)for(b=e.overlay_preserve.replace(/&/g,",&,").split(","),d=e.overlay_preserve_position,null!=d&&(d=d.split(",")),c=0,la=Array(ub.length),a=S=0;a<ub.length;a++)if(ub[a]){la[a]=[];Q=0;do{la[a][Q]=[];for(g=0;4>g;g++)la[a][Q][g]=parseInt(b[S].trim(),10),S+=1;la[a][Q][2]=la[a][Q][2]-la[a][Q][0]+1;la[a][Q][3]=la[a][Q][3]-la[a][Q][1]+1;null!=d?(la[a][Q][4]=parseInt(d[c],10),la[a][Q][5]=parseInt(d[c+1],10),c+=2):(la[a][Q][4]=la[a][Q][0],la[a][Q][5]=la[a][Q][1]);S<b.length&&"&"==b[S].trim()?(S+=1,Q+=1,g=
!0):g=!1}while(g)}$e=0;zh=" ";Cc="white";he="transparent";ie="14pt arial";Ah=!1;a=e.times_label_style;null!=a&&(b=a.split(","),Cc=b[0].trim(),1<b.length&&($e=Math.floor(60*parseFloat(b[1]))),1<b.length&&($e="?"==b[1].trim()||"auto"==b[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(b[1]))),2<b.length&&(zh=b[2].trim()),3<b.length&&(he=b[3].trim()),4<b.length&&(ie=b[4].trim()),5<b.length&&-1!=b[5].trim().indexOf("t")&&(Ah=!0));0==Cc.indexOf("0x")&&(Cc="#"+
Cc.substring(2));0==he.indexOf("0x")&&(he="#"+he.substring(2));zd=parseInt(ie,10);Hi=new nb("black","white",ie,"black",20,5,5);Bh=!1;Bh=z(e.to_from_lock,"t")?!0:!1;a="black";g="white";l="14px arial";d=null;Q=S=c=10;Ch=Dh=" ";fg=Ad=null;a=e.dirspd_display_style;null!=a&&(b=a.split(","),a=b[0].trim(),g=b[1].trim(),l=b[2].trim(),Ch=b[3],Dh=b[4],5<b.length&&(d=b[5].trim(),c=parseInt(b[6],10),S=parseInt(b[7],10),Q=parseInt(b[8],10)),fg=new nb(a,g,l,d,c,S,Q));d="black";c="white";S="14px arial";Q=null;k=
l=g=10;a=e.tipbox_display_style;null!=a&&(b=a.split(","),d=b[0].trim(),c=b[1].trim(),S=b[2].trim(),3<b.length&&(Q=b[3].trim(),g=parseInt(b[4],10),l=parseInt(b[5],10),k=parseInt(b[6],10)));Eh=new nb(d,c,S,Q,g,l,k);Bd=null;ia=e.image_base;null!=ia?Bd=ia=ia.trim():ia=null!=e.image_only_base?e.image_only_base.trim():null;Fh=ia;a=e.overlay_base;null!=a&&(vb=a.trim());af=!0;z(e.zip_only,"f")&&(af=!1);Uc=!1;a=e.zip_filename;null!=a&&(Uc=!0,gg=a.trim());sd=!0;a=e.filenames;null==a&&(a=e.background_filenames);
null!=a&&Ii(a);a=e.basename;null!=a&&(d=e.base_starting_number,c=0,S=1,null!=d&&(b=d.split(","),c=parseInt(b[0],10),1<b.length&&(S=parseInt(b[1],10))),t=e.num_frames,null==t&&(t=e.num_images),t=parseInt(t,10),Ji(a,c,S));hg=!0;b=e.zip_static;if(z(b,"f")||z(b,"n"))hg=!1;ig=!0;b=e.background_static;if(z(b,"f")||z(b,"n"))ig=!1;a=e.overlay_filenames;null!=a&&Ki(a);Pa=null;a=e.image_preserve;if(null!=a)for(b=a.split(","),Pa=[],a=0;a<b.length;a++)Pa[a]=parseInt(b[a].trim(),10),1<a%4&&(Pa[a]=Pa[a]-Pa[a-2]+
1);Gh=!1;z(e.keep_enhancement,"t")&&(Gh=!0);Hh=!0;z(e.keep_zoom,"f")&&(Hh=!1);Cd=jg=0;Ih=!1;a=e.hide_bottom;null!=a&&(b=a.split(","),jg=parseInt(b[0].trim(),10),1<b.length&&z(b[1],"t")&&(Ih=!0));Dd=kg=0;Jh=!1;a=e.hide_top;null!=a&&(b=a.split(","),kg=parseInt(b[0].trim(),10),1<b.length&&z(b[1],"t")&&(Jh=!0));Ed=lg=0;Kh=!1;a=e.hide_left;null!=a&&(b=a.split(","),lg=parseInt(b[0].trim(),10),1<b.length&&z(b[1],"t")&&(Kh=!0));Fd=mg=0;Lh=!1;a=e.hide_right;null!=a&&(b=a.split(","),mg=parseInt(b[0].trim(),
10),1<b.length&&z(b[1],"t")&&(Lh=!0));Mh=!1;z(e.hide_background,"t")&&(Mh=!0);Nh="<div>";Oh=300;Ph=500;a=e.popup_style;null!=a&&(Nh='<div style="'+a+'">');a=e.popup_window_size;null!=a&&(b=a.split(","),Ph=b[0],Oh=b[1]);Qh=!1;a=e.wheel_frames;null!=a&&(Qh=!0,oa.useWheel(HAniS.wheel));Rh=Fa=!1;z(e.active_zoom,"t")&&(null==Ka&&(Fa=!0),oa.useWheel(HAniS.wheel));ng=!1;z(e.cycle_zoom,"t")&&(ng=!0);a=e.initial_zoom;null!=a&&(b=a.split(","),Dc="auto"!=b[0].toLowerCase()?parseFloat(b[0]):"auto",1<b.length?
(je=parseInt(b[1],10),Sh=parseInt(b[2],10)):je=-1,Th=!0);Gd=1;Hd=!1;ta=null;a=e.zoom_scale;if(null!=a)if(b=a.split(","),1===b.length)z(a,"hi_res")?(Hd=!0,Gd=0):Gd=parseFloat(a);else{ta=Array(b.length);for(a=0;a<b.length;a++)ta[a]=parseFloat(b[a]);Hd=!0}Vc=9999999;a=e.maximum_zoom;null!=a&&(Vc=parseFloat(a));bf=!0;z(e.use_progress_bar,"f")&&(bf=!1);a=e.dwell;null!=a&&(b=a.split(","),Ga=parseInt(b[0].trim(),10),1<b.length&&(gc=parseInt(b[1].trim(),10),10>gc&&(gc=10),Wc=parseInt(b[2].trim(),10),og=parseInt(b[3].trim(),
10)));a=e.rate;null!=a&&(b=a.split(","),Ga=Math.round(1E4/parseFloat(b[0].trim())),1<b.length&&(gc=Math.round(1E4/parseFloat(b[2].trim())),10>gc&&(gc=10),Wc=Math.round(1E4/parseFloat(b[1].trim()))));a=e.frame_times_template;null!=a&&(b=a.split(","));Id=27;a=e.mp4_quantization;null!=a&&(Id=parseInt(a,10),10>Id||51<Id)&&(Id=27);wb=null;a=e.times;if(null!=a){b=a.split(",");wb=Array(b.length);for(a=0;a<b.length;a++)wb[a]=parseInt(b[a].trim(),10);aa(wb)}a=e.extrap_times_filename;if(null!=a){wb=[];var h=
new XMLHttpRequest;h.open("get",a,!0);h.onload=function(){for(var a=h.responseText.split("\n"),b=0;b<a.length;b++){var d=a[b].split(" ");if(3==d.length){d[2].trim();var g=parseInt(d[0],10)-1;wb[g]=100*parseInt(d[2].substring(0,2),10)+parseInt(d[2].substring(3,5),10)+parseInt(d[2].substring(6,8),10)/30}}aa(wb)};h.send()}ke=null;a=e.extrap_times_template;null!=a&&(ke=RegExp(a));Uh=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];
Vh=10;z(e.extrap_prompts_position,"bot")&&(Vh=9999);a=e.extrap_prompts;null!=a&&(Uh=a.split(","));cf=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&(cf=a.split(","));df=!0;z(e.mark_close,"f")&&(df=!1);pg="12pt Arial";Wh="white";a=e.mark_prompts_style;null!=a&&(b=a.split(","),pg=b[0].trim(),1<b.length&&(Wh=b[1].trim()));Xh=e.controls;ha("controls = "+e.controls);ha("bottom_controls = "+e.bottom_controls);Xc=ef=hc=ic=xb=yb=ff=Kb=null;null!=Xh&&lb(Xh,!0);
Yh=e.bottom_controls;null!=Yh&&lb(Yh,!1);Yc=!1;a=e.probe_table;null!=a&&q(a);b=e.enhance_filename;null==b&&(b=e.enhance_table);if(null!=b){ha("Reading enhancement table...");Yc=!1;h=new XMLHttpRequest;zb=[];Zc=[];gf=[];$c=[];jc=[];var T,Ec,m;bb=[];cb=[];db=[];le=[];v=-1;Zh=!0;var qg=!1,r,A,y,n,F,x,H,R,I,C,K,L,D;h.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var d=a[b].replace(/\s+/g," ").trim(),g=d.indexOf("#");if(0!=g)if(0<g&&(d=d.substring(0,
g)),g=d.split(","),0==g[0].indexOf("*"))v++,zb[v]=Array(256),$c[v]=Array(256),Zc[v]=Array(256),jc[v]=Array(256),bb[v]=Array(256),cb[v]=Array(256),db[v]=Array(256),le[v]=Array(256),zb[v]=Array(256),gf[v]=1<g.length?g[1].trim():"None",T=" ",Ec="Value =",m=1,d=p("option"),d.innerHTML=g[0].substring(1),d.value=v,null!=Ca&&Ca.add(d);else{var c=d.indexOf("value");0>c&&(c=d.indexOf("probe"));qg=!1;C=K=0;0<c&&(g=d.substring(c+1),d=d.substring(0,c),c=g.indexOf("="),g=g.substring(c+1),g=g.split(","),1==g.length?
(Ec=g[0].trim(),m=-1,qg=!1):(C=parseFloat(g[0].trim()),K=parseFloat(g[1].trim()),2<g.length&&(m=parseInt(g[2],10)),3<g.length&&(T=Li(g[3].trim())),4<g.length&&(Ec=g[4].trim()),qg=!0));d=d.split(" ");r=parseInt(d[0].trim(),10);A=parseInt(d[1].trim(),10);y=A-r;n=parseFloat(d[2].trim());F=parseFloat(d[3].trim());x=parseFloat(d[4].trim());H=parseFloat(d[5].trim());R=parseFloat(d[6].trim());I=parseFloat(d[7].trim());L=D=255;9<d.length&&(L=parseFloat(d[8].trim()),D=parseFloat(d[9].trim()));for(d=r;d<=A;d++)0===
y?(bb[v][r]=n,cb[v][r]=x,db[v][r]=R,le[v][r]=L):(bb[v][d]=Math.round(n+(F-n)*(d-r)/y),cb[v][d]=Math.round(x+(H-x)*(d-r)/y),db[v][d]=Math.round(R+(I-R)*(d-r)/y),le[v][d]=Math.round(L+(D-L)*(d-r)/y)),$c[v][d]=Ec,Zc[v][d]=T,jc[v][d]=m,qg&&(zb[v][d]=C+(K-C)*(d-r)/y)}}-1!=tb&&w[tb].checked&&(Ca.disabled=!1);Yc=!0;f()};h.open("get",b,!0);h.send()}else f()}function f(){var b=e.sprite_filenames;if(null!=b){var a=b.split(",");rg=0;pa=[];b=e.sprite_images_offset;ad=-1;null!=b&&(ad=parseInt(b,10)-1);for(b=0;b<
a.length;b++){pa[b]=new Image;pa[b].gotit=!1;pa[b].inx=b;pa[b].fromfile=!0;var g="/";0<a[b].indexOf("?")&&(g="?");pa[b].zoomme=0<a[b].indexOf(g+"zoom");pa[b].anim=0<a[b].indexOf(g+"animate");g=a[b].indexOf(g);0<g&&(a[b]=a[b].substring(0,g));pa[b].onload=function(){pa[this.inx].gotit=!0;rg++;rg==a.length&&h()};pa[b].src=a[b].trim()}}else h()}function h(){for(var b=Object.keys(e),a=0;a<b.length;a++)z(b[a],"hotspot")&&Xb("hotspot="+e[b[a]]);sd?HAniS.getFOF():(Fc=!0,Wb())}function q(b){var a=new XMLHttpRequest;
zb=[];gf=[];Zc=[];var g=" ";$c=[];var d="Value=";jc=[];var c=1;bd=[];sg=[];bb=[];cb=[];db=[];var e,f=-1;v=-1;var l=0;a.onload=function(){for(var a=this.responseText.split("\n"),b=0;b<a.length;b++)if(!(2>a[b].length)){var B=a[b].replace(/\s+/g," ").trim().split(","),S=B[0].split(" ");if(0==S[0].indexOf("*"))v++,zb[v]=[],$c[v]=[],Zc[v]=[],jc[v]=[],bb[v]=[],cb[v]=[],db[v]=[],sg[v]=[],bd[v]=[],f=-1,gf[v]=1<B.length?B[1].trim():"None",l=1;else if(0!=l){f++;var k=Array(3);zb[v][f]=parseFloat(S[0]);bb[v][f]=
parseInt(S[1].trim(),10);cb[v][f]=parseInt(S[2].trim(),10);db[v][f]=parseInt(S[3].trim(),10);0!=f&&(k[0]=bb[v][f]-bb[v][f-1],k[1]=cb[v][f]-cb[v][f-1],k[2]=db[v][f]-db[v][f-1],e=0,Math.abs(k[1])>Math.abs(k[e])&&(e=1),Math.abs(k[2])>Math.abs(k[e])&&(e=2),sg[v][f-1]=e,bd[v][f-1]=k,0==bd[v][f-1][e]&&(bd[v][f-1][e]=1));1<B.length&&(0==B[1].trim().indexOf('"')?(c=-1,B=B[1].trim(),d=B.substr(1,B.length-2),g=""):(c=parseInt(B[1],10),2<B.length&&(g=Li(B[2].trim())),3<B.length&&(d=B[3].trim())));$c[v][f]=d;
jc[v][f]=c;Zc[v][f]=g}}Yc=!0};a.open("get",b,!0);a.send()}function E(b){b=b.split(",");var a=b[0].trim();"PS"===a?(kc=new ej,kc.init(b)):"CE"==a?(kc=new fj,kc.init(b)):"LCC"==a?(kc=new gj,kc.init(b)):(kc=null,tg=parseFloat(b[0]),ug=parseFloat(b[1]),Mi=parseFloat(b[2]),vg=parseFloat(b[3]),0<ug&&0>vg&&(vg+=360));null==e.coordinates_display_style&&(Oe="Lat = ",Pe=" Lon = ");ud=!0}function Gb(b){var a=new XMLHttpRequest;a.onload=function(){c(this.responseText.split("\n"))};a.open("get",b+"?"+Math.round(1E5*
Math.random()),!0);a.send()}function wc(b){var a;if(null!=yd){for(a=0;a<yd.length;a++)-1!=yd[a].indexOf(b)&&(w[a].checked=!1);for(a=0;a<yd.length;a++)Ib(a)}}function aa(b){wg=Array(b.length);for(var a=0;a<b.length;a++){var g=60*Math.floor(b[a]/100)+Math.floor(b[a])%100;0===a&&(lc=g);var d=g-lc;0>d&&(d=g+1440-lc);wg[a]=d;ha("times s="+g+"  min="+wg[a])}lc+=$e;1440<=lc&&(lc-=1440);0>lc&&(lc+=1440);ha("Starting minute = "+lc)}function kb(b,a){if(0!=b&&!cd)for(var g=0;g<b;g++)0==w[Qa[g].overlay].isGhost&&
(w[Qa[g].overlay].parentNode.style.visibility=a)}function ma(){var b,a,g,d,c;if(xg){var e=new XMLHttpRequest;var f=0;O=[];e.onload=function(){var B=this.responseText.split("\n");ha("Processing FoF-substitute: "+$h);for(g=0;g<B.length;g++)if(!(2>B[g].length||0>B[g].indexOf(Ni))&&(O[f]=[],c=B[g].indexOf("overlay"),0<=c)){b=B[g].substring(c);c=b.indexOf("=");0>c&&ha("!! Cannot find a = sign in "+b);a=b.substring(c+1);b=a.trim();a=b.split(",");Y=Math.max(Y,a.length);ha("numOverlays reset in fof_substitute to "+
Y);for(d=0;d<a.length;d++)O[f][d]=a[d].trim(),null!=me&&yg[d]?O[f][d]=(me+O[f][d]).trim():null!=vb?O[f][d]=(vb+O[f][d]).trim():null!=ia&&(O[f][d]=(ia+O[f][d]).trim());f+=1}ha("Number of frames "+t+"... number of fof_sub frames = "+f);Ke()};e.open("get",$h+"?"+Math.round(1E5*Math.random()),!0);e.send()}else Ke()}function Ke(){0!=Ab?kb(Ab,"visible"):0!=ai&&kb(ai,"hidden");Fc=!0;Wb()}function qd(b,a){Jd||(sb.height=a,sb.width=b,zc.height=a,zc.width=b,ne.height=a,ne.width=b,hf.height=a,hf.width=b,oe=
hf.getContext("2d"),M=2*Math.floor(b/2),P=2*Math.floor(a/2),fe&&(b=jf*P/M,a=jf,b<pe&&(a=pe*M/P,b=pe),qa=a,ra=b),kf=M/2-100,lf=P/2-10,H=1*qa/M,I=1*ra/P,Ha=Math.floor(ra/K),Ia=Math.floor(qa/C),Wa.style.height=P+"px",Wa.style.width=M+"px",Gc.style.height=P+"px",Gc.style.width=M+"px",qe.style.height=P+"px",qe.style.width=M+"px",Le(t,!1),bi&&(bi=!1,null!=re&&re()))}function Pf(){for(var b=0,a={},g=0;g<t;a={$jscomp$loop$prop$ii$2:a.$jscomp$loop$prop$ii$2},g++){a.$jscomp$loop$prop$ii$2=g;var d=null==ia?
ya[g]:ya[g].substring(ya[g].lastIndexOf("/")+1);(d=ci.file(d))?d.async("arraybuffer").then(function(a){return function(d){d=new Blob([d]);Hc[a.$jscomp$loop$prop$ii$2]=URL.createObjectURL(d);b++;b>=t&&Na()}}(a),function(a){return function(){Hc[a.$jscomp$loop$prop$ii$2]=null;b++;b>=t&&Na()}}(a)):(Hc[a.$jscomp$loop$prop$ii$2]=null,b++,b>=t&&Na())}}function Na(){var b=0;if(0==Y)Hb();else for(var a=0;a<t;a++){Ic[a]=[];for(var g={},d=0;d<Y;g={$jscomp$loop$prop$ii$6:g.$jscomp$loop$prop$ii$6,$jscomp$loop$prop$jj$7:g.$jscomp$loop$prop$jj$7},
d++){g.$jscomp$loop$prop$ii$6=a;g.$jscomp$loop$prop$jj$7=d;var c=null==vb&&null==ia?O[a][d]:O[a][d].substring(O[a][d].lastIndexOf("/")+1);(c=ci.file(c))?c.async("arraybuffer").then(function(a){return function(d){d=new Blob([d]);Ic[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=URL.createObjectURL(d);b++;b>=t*Y&&Hb()}}(g),function(a){return function(){Ic[a.$jscomp$loop$prop$ii$6][a.$jscomp$loop$prop$jj$7]=null;b++;b>=t*Y&&Hb()}}(g)):(Ic[a][d]=null,b++,b>=t*Y&&Hb())}}}function Wb(){if(Uc){var b=
new XMLHttpRequest,a=null==Bd?gg:Bd+gg;hg||(a=a+"?"+Math.round(1E5*Math.random()));b.open("GET",a,!0);b.responseType="arraybuffer";Hc=[];Ic=[];b.addEventListener("progress",function(a){a.lengthComputable&&xa("Loading ZIP file",a.total,a.loaded)});b.onload=function(a){(new JSZip).loadAsync(this.response).then(function(a){ci=a;Pf()},function(){ha("Unable to read ZIP file: "+gg)})};b.send()}else Hb()}function Hb(){var b,a,g;void 0!=mf&&mf(!1);var d="?"+Math.round(1E4*Math.random()),c=[];c[0]=Lb;null!=
Bb&&(Bb.disabled=!0);null!=Mb&&(Mb.disabled=!0);for(b=1;b<t;b++)c[b]=b<=Lb?b-1:b;Ra=Array(t);mc=Sa=0;di=bf;zg&&(La.max=t);Jd&&(Kd||Rc)&&(nc=[],Xa=[],dd=[],Ag=[],nf=[]);null!=Ca&&(Gh?null==td&&(td=Ca.value):Ca.selectedIndex=0);for(var e=0;e<t;e++){b=c[e];Jd&&(Kd||Rc)&&(nc[b]=p("canvas"),Xa[b]=p("canvas"));Ra[b]=new Image;Ra[b].gotit=!1;Ra[b].frameNum=b;Ra[b].onerror=function(){Sa++};Ra[b].onload=function(){Jd&&(ra=this.height,qa=this.width,pe=ra,jf=qa,Jd=!1,ph?fe?HAniS.setWindowSize(u.offsetWidth,
u.offsetHeight):qd(M,P):qd(qa,ra),Ha=ra,Ia=qa,Th&&("auto"==Dc&&(Dc=(H+I)/2,je=-1),Ha/=Dc,Ia/=Dc,0>je&&(je=qa/2,Sh=ra/2),G=Math.round(je-qa/2/Dc),J=Math.round(Sh-ra/2/Dc),C=K=Dc,1!=Dc&&(Fa=!1,HAniS.toggleZooming()),Cd=jg,Dd=kg,Fd=mg,Ed=lg,Mc()));Uc&&null!=Hc[this.frameNum]&&URL.revokeObjectURL(Hc[this.frameNum]);if(0<of&&!Ld){Bg.height=ra;Bg.width=qa;se=Bg.getContext("2d");se.clearRect(0,0,M,P);for(var b=0;b<Ya.length;b++){for(var e=Ya[b].ctx.getImageData(0,0,Ya[b].width,Ya[b].height).data,f=se.getImageData(Ya[b].xmin,
Ya[b].ymin,Ya[b].width,Ya[b].height),B=3;B<e.length;B+=4)0!=e[B]&&(f.data[B]=b+1);se.putImageData(f,Ya[b].xmin,Ya[b].ymin)}Fa||(pb=!0);C==pf&&(pb=!0);Ld=!0}if(Fc){Fc=!1;D=sb.getContext("2d");D.imageSmoothingEnabled=wd;D.imageSmoothingQuality=nh;D.fillStyle="blue";D.font="bold 20px Arial";k=zc.getContext("2d");k.imageSmoothingEnabled=wd;Za=Array(t);Le(t,!0);qf&&!za?wa(na(Lb)):wa(na(m));if(0<Y)for(N=Array(t),B=0;B<t;B++)for(g=c[B],N[g]=Array(Y),a=0;a<Y;a++)if(void 0!=Jb[a+1]&&Jb[a+1]>=t&&(Jb[a+1]=t-
1),void 0==Jb[a+1]||Jb[a+1]==g)N[g][a]=new Image,N[g][a].gotit=!1,N[g][a].frameNum=g,N[g][a].overlayNum=a,N[g][a].onerror=function(){Sa++},N[g][a].onload=function(){this.gotit=!0;var a=this.frameNum;Sa++;Nc();!Xe||this.height==pe&&this.width==jf?this.overlayNum==ge-1&&(Za[this.frameNum]=0):(this.gotit=!1,ha("Bad image size:"+this.src));if(Rc&&this.gotit&&this.overlayNum==tb)nc[a].height=this.height,nc[a].width=this.width,te=nc[a].getContext("2d"),te.drawImage(this,0,0),Ag[a]=te.getImageData(0,0,this.width,
this.height).data,Xa[a].height=this.height,Xa[a].width=this.width,dd[a]=Xa[a].getContext("2d"),dd[a].drawImage(this,0,0),nf[a]=dd[a].getImageData(0,0,this.width,this.height),N[a][this.overlayNum]=null,N[a][this.overlayNum]=Xa[a],N[a][this.overlayNum].gotit=!0;else if(this.gotit&&w[this.overlayNum].hotspotIndex){var b=p("canvas");b.height=this.height;b.width=this.width;var d=b.getContext("2d");d.drawImage(this,0,0);var g=d.getImageData(0,0,this.width,this.height).data,c=g.length;var B=this.overlayNum;
var e;for(e=0;e<c;e+=4)if(0!=g[e]){0==eb&&(fb=[]);var f=g[e];var l=Math.floor(e/4/b.width);d=Math.floor(e/4%b.width);fb[eb]=new mb(d,l,"spritefn",f,"pan",null,null,B,a,null,null);eb++}}else if(this.gotit&&th&&(!eg||eg&&xh[this.overlayNum])){b=p("canvas");b.height=this.height;b.width=this.width;d=b.getContext("2d");d.drawImage(this,0,0);l=d.getImageData(0,0,this.width,this.height);g=l.data;c=g.length;for(e=0;e<c;e+=4)g[e]===uh&&g[e+1]===vh&&g[e+2]===wh&&(g[e+3]=0);d.putImageData(l,0,0);N[a][this.overlayNum]=
null;N[a][this.overlayNum]=b;N[a][this.overlayNum].gotit=!0}this.gotit&&dg[this.overlayNum]?(Cg.clearRect(0,0,M,P),Cg.drawImage(N[a][this.overlayNum],0,0,M,P)):this.gotit&&rh[this.overlayNum]&&null!=V&&(b=p("canvas"),b.height=ra,b.width=qa,8>V.length&&(V[4]=0,V[5]=0,V[6]=qa,V[7]=ra),d=b.getContext("2d"),d.imageSmoothingEnabled=sh,d.drawImage(this,V[0],V[1],V[2],V[3],V[4],V[5],V[6],V[7]),N[a][this.overlayNum]=null,N[a][this.overlayNum]=b,N[a][this.overlayNum].gotit=!0,null!=ub&&ub[this.overlayNum]&&
(N[a][this.overlayNum].origImage=this));Uc&&null!=Ic[a][this.overlayNum]&&URL.revokeObjectURL(Ic[a][this.overlayNum]);if(void 0!=Jb[this.overlayNum+1]&&Jb[this.overlayNum+1]==a)for(b=0;b<t;b++)b!=a&&(N[b][this.overlayNum]=N[a][this.overlayNum],Sa++)},b=O[g][a],void 0==ue||ue[a]||(b+=d),N[g][a].src=Uc&&(af||Ic[g][a])?Ic[g][a]:b,mc++;if(null!=ed)for(oc=[],a=0;a<ed.length;a++)oc[a]=new Image,oc[a].gotit=!1,oc[a].onerror=function(a){Sa++},oc[a].onload=function(a){a.currentTarget.gotit=!0;Sa++;Nc()},oc[a].src=
ed[a],mc++;if(null!=Ta&&0<Ta.length)for(Aa=[],a=0;a<Ta.length;a++)if(void 0!=Ta[a])for(Aa[a]=[],g=0;g<Ta[a].length;g++)for(Aa[a][g]=[],B=0;B<t;B++)Oi(Ta[a][g],"/")?(b=O[B][a].lastIndexOf("/"),b=O[B][a].substring(0,b+1)+Ta[a][g]+O[B][a].substring(b+1),Aa[a][g][B]=new Image,Aa[a][g][B].gotit=!1,Aa[a][g][B].onerror=function(a){Sa++;Nc()},Aa[a][g][B].onload=function(a){a.currentTarget.gotit=!0;Sa++;Nc()},Aa[a][g][B].src=b,mc++):0===B?(Aa[a][g][0]=new Image,Aa[a][g][0].gotit=!1,Aa[a][g][0].onerror=function(a){Sa++;
Nc()},Aa[a][g][0].onload=function(a){a.currentTarget.gotit=!0;Sa++;Nc()},Aa[a][g][0].src=Ta[a][g],mc++):Aa[a][g][B]=Aa[a][g][0]}!Xe&&0!=this.height&&0!=this.width||this.height==pe&&this.width==jf?(this.gotit=!0,0==ge&&(Za[this.frameNum]=0)):(this.gotit=!1,ha("Image has invalid size:"+this.src));Kd&&this.gotit&&(B=this.frameNum,nc[B].height=this.height,nc[B].width=this.width,te=nc[B].getContext("2d"),te.drawImage(this,0,0),Ag[B]=te.getImageData(0,0,this.width,this.height).data,Xa[B].height=this.height,
Xa[B].width=this.width,dd[B]=Xa[B].getContext("2d"),dd[B].drawImage(this,0,0),nf[B]=dd[B].getImageData(0,0,this.width,this.height),Ra[B]=null,Ra[B]=Xa[B],Ra[B].gotit=!0);Sa++;Nc();Hh||HAniS.resetZoom();fd=!0;Pi||(Pi=!0,Da=!1,Qi());F(za)};var f=ya[b];void 0!=Jb[0]&&(f=Jb[0],f>=t&&(f=t-1),f=ya[f]);ig||(f+=d);Ra[b].src=Uc&&(af||Hc[b])?Hc[b]:f;mc++}gd=Nb=!1;fa()}function ea(b,a,g,d,c,f){b.label_on=g;b.label_off=d;ob&&(b.className=f);g=null;d=e[a+"_labels"];null==d&&(d=e[a+"_label"]);null!=d&&(d=d.split(","),
b.label_on=d[0].trim(),1<d.length&&(b.label_off=d[1].trim()),2<d.length&&(g="width:"+d[2].trim()+"px;"));null!=c&&(b.title=c);b.innerHTML=b.label_on;c=a=d=e[a+"_style"];null!=d&&(d=d.split("&"),1<d.length&&(a=d[0],c=d[1]));b.style_on=(null!=g?g:"")+Jc+a;b.style_off=(null!=g?g:"")+Jc+c;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):(b.style_on=null,b.style_off=null)}function lb(b,a){Jc=e.buttons_style;null==Jc&&(Jc="");var g=null,d=null;g=a?e.controls_tooltip:e.bottom_controls_tooltip;
var c=b.split(",");if(null!=g){var f=g.split(",");f.length!=c.length&&(ha("!!! Number of tooltips must equal number of controls!"),f=g=null)}var k={};for(b=0;b<c.length;k={$jscomp$loop$prop$sfbounds$11:k.$jscomp$loop$prop$sfbounds$11},b++){var l=null!=g?f[b]:null;var h=c[b].trim();d=h.indexOf("/");if(0===d||0===b){0===d&&(h=h.substring(1));y=p("div");y.align=be;var q=e.controls_style;null!=q?y.setAttribute("style",q):y.setAttribute("style","position:relative;padding:2px;width:100%;");a?(u.insertBefore(y,
Wa),rf=y,rf.id=sf+"-top-controls"):(q=e.bottom_controls_style,null!=q&&y.setAttribute("style",q),u.appendChild(y),tf=y,tf.id=sf+"-bottom-controls")}"enhance"==h.trim()&&(Ca=p("select"),d=e.enhance_style,null!=d&&Ca.setAttribute("style",d),null!=l&&(Ca.title=l),d=p("option"),d.innerHTML=void 0==e.enhance_prompt?"Pick Enhancement":e.enhance_prompt,d.value=-1,Ca.add(d),Ca.addEventListener("change",HAniS.doEnhance,!1),Kd=!Rc,Ca.disabled=Kd?!1:!0,y.appendChild(Ca));"custom"==h&&(ff=p("button"),ea(ff,"custom",
"On","Off",l,"custom"),y.appendChild(ff));"mp4"==h&&(Mb=p("button"),ea(Mb,"mp4","Make MP4","Stop",l,"mp4"),Mb.addEventListener("click",HAniS.makeMP4,!1),y.appendChild(Mb));"anigif"==h&&(Bb=p("button"),ea(Bb,"anigif","Make GIF","Stop",l,"anigif"),Bb.addEventListener("click",HAniS.makeAniGIF,!1),y.appendChild(Bb));"startstop"==h&&(Kb=p("button"),ea(Kb,"startstop","Start","Stop",l,"startstop start"),Kb.addEventListener("click",HAniS.toggleIsLooping,!1),y.appendChild(Kb));"looprock"==h&&(ve=p("button"),
ea(ve,"looprock","Rock","Loop",l,"looprock rock"),we=1,ve.addEventListener("click",HAniS.toggleLoopRock,!1),y.appendChild(ve),z(e.start_rocking,"t")&&HAniS.toggleLoopRock());"loophalt"==h&&(xe=p("button"),ea(xe,"loophalt","Halt","Loop",l,"loophalt halt"),Cb=!1,xe.addEventListener("click",HAniS.toggleLoopHalt,!1),y.appendChild(xe));"extrap"==h&&(pc=p("button"),ea(pc,"extrap","Enable Extrap","Disable Extrap",l,"extrap"),pc.addEventListener("click",HAniS.toggleExtrap,!1),y.appendChild(pc));z(h,"location")&&
(Md=p("button"),ea(Md,"location","Show Loc","Hide Loc",l,"location"),0<h.indexOf("/on")?(L(Md,!1,"location off"),Nd=!0,Ma.push(u.style.cursor),u.style.cursor=Ue):(Nd=!1,u.style.cursor=Ma.pop()),Md.addEventListener("click",function(){(Nd=!Nd)?(L(Md,!1,"location off"),Ma.push(u.style.cursor),u.style.cursor=Ue):(L(Md,!0,"location on"),u.style.cursor=Ma.pop());fa()},!1),y.appendChild(Md));"distance"==h&&(qc=p("button"),ea(qc,"distance","Show dist","Hide dist",l,"distance"),ac=Se=!1,qc.addEventListener("click",
function(){(ac=!ac)?(L(qc,!1,"distance off"),Ma.push(u.style.cursor),u.style.cursor=Tf):(L(qc,!0,"distance on"),u.style.cursor=Ma.pop())},!1),y.appendChild(qc));z(h,"probe")&&(Od=p("button"),ea(Od,"probe","Show probe","Hide probe",l,"probe"),0<h.indexOf("/on")?(L(Od,!1,"probe off"),bc=!0,Ma.push(u.style.cursor),u.style.cursor=Ve):(bc=!1,u.style.cursor=Ma.pop()),Od.addEventListener("click",function(){(bc=!bc)?(L(Od,!1,"probe off"),Ma.push(u.style.cursor),u.style.cursor=Ve):(L(Od,!0,"probe on"),u.style.cursor=
Ma.pop())},!1),y.appendChild(Od));"mark"==h&&(hd=p("button"),ea(hd,"mark","Mark","Stop Mark",l,"mark"),ye=!0,hd.addEventListener("click",function(){Db=!Db;ua=[];Db?(Pd=0,L(hd,!1,"mark off"),null!=Ka&&(Ka.disabled=!0),Ma.push(u.style.cursor),u.style.cursor=Uf):(L(hd,!0,"mark on"),null!=Ka&&(Ka.disabled=!1),Pd=-1,u.style.cursor=Ma.pop());fa()},!1),Ri=new nb("black","white",pg,"black",20,5,5),ei=new nb("black","white",pg,"black",20,5,5),y.appendChild(hd));"refresh"==h&&(ef=p("button"),ea(ef,"refresh",
"Refresh",null,l,"refresh"),ef.addEventListener("click",HAniS.reloadFOF,!1),y.appendChild(ef));"restore"==h&&(Dg=p("button"),ea(Dg,"restore","Restore",null,l,"restore"),Dg.addEventListener("click",function(a){for(a=0;a<w.length;a++)w[a].checked=w[a].restorableState;for(a=0;a<w.length;a++)Ib(a)},!1),y.appendChild(Dg));"setframe"==h&&(k.$jscomp$loop$prop$sfbounds$11=function(){var a=parseInt(La.value,10)-1;if(uf||Eg){for(var b=0;b<t;b++)Ja(b,0);vf=0}else if(a!=fi&&Fg){if(0==vf){for(b=0;b<t;b++)b>a?
Ja(b,0):Ja(b,-1);vf=1}else{for(b=a+1;b<t;b++)Ja(b,-1);vf=0;F(!0)}fi=a}},La=p("input"),ob&&(La.className="setframe"),La.type="range",La.min=1,La.max=100,La.value=1,wf="Frame #*",null!=l&&(La.title=l),q=e.setframe_label,null!=q&&(wf=q),ze=p("span"),ze.innerHTML=wf.replace("*",1),d="display:block;vertical-align:middle;"+e.setframe_style,La.setAttribute("style",d),d=p("span"),d.setAttribute("style","display:inline-block;vertical-align:top;"),ze.setAttribute("style","display:block;vertical-align:middle;"+
e.setframe_label_style),d.appendChild(ze),d.appendChild(La),y.appendChild(d),y.addEventListener("touchmove",function(a){a.stopPropagation()},!1),y.addEventListener("mousemove",function(a){a.stopPropagation()},!1),La.addEventListener("input",function(a){a.preventDefault();a.stopPropagation();F(!1);a=parseInt(La.value,10)-1;0<=Za[a]&&(wa(a),ze.innerHTML=wf.replace("*",m+1));U()},!1),vf=0,fi=-1,La.addEventListener("pointerup",function(a){return function(b){b.stopPropagation();a.$jscomp$loop$prop$sfbounds$11()}}(k),
!1),La.addEventListener("mouseup",function(a){return function(b){b.stopPropagation();a.$jscomp$loop$prop$sfbounds$11()}}(k),!1),La.addEventListener("change",function(a){return function(b){b.stopPropagation();a.$jscomp$loop$prop$sfbounds$11()}}(k),!1),zg=!0);"framelabel"==h&&(Ua=p("button"),ob&&(Ua.className="framelabel"),Ua.innerHTML="",null!=l&&(Ua.title=l),gb=null,q=e.frame_labels,null!=q&&(gb=q.split(","),Ua.innerHTML=gb[0]),d=Jc+e.framelabel_style,null!=d&&Ua.setAttribute("style",d),d=e.framelabel_position,
null!=d&&(d=d.split(","),Ua.style.position="absolute",Ua.style.left=u.offsetLeft+parseInt(d[0],10)+"px",Ua.style.top=u.offsetTop+parseInt(d[1],10)+"px"),y.appendChild(Ua));if("autorefresh"==h||"autorefresh/off"==h)null!=Pc&&clearInterval(Pc),Xc=p("button"),ea(Xc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",l,"autorefresh"),Xc.addEventListener("click",HAniS.toggleAutoRefresh,!1),ee=!1,y.appendChild(Xc),"autorefresh"==h?HAniS.toggleAutoRefresh():L(Xc,!1,"autotoggle off");"backward"==h&&
(xb=p("button"),ea(xb,"backward","<","<",l,"step back"),xb.addEventListener("click",function(){F(!1);rb(-1);U()},!1),y.appendChild(xb));"forward"==h&&(yb=p("button"),ea(yb,"forward",">",">",l,"step forward"),yb.addEventListener("click",function(){F(!1);rb(1);U()},!1),y.appendChild(yb));if("step"==h){d=e.step_labels;var T=null!=d?d.split(","):["<",">"];xb=p("button");ob&&(xb.className="step back");xb.innerHTML=T[0];xb.addEventListener("click",function(){F(!1);rb(-1);U()},!1);d=Jc+e.step_style;null!=
d&&xb.setAttribute("style",d);null!=l&&(xb.title=l);y.appendChild(xb);yb=p("button");ob&&(yb.className="step forward");yb.innerHTML=T[1];yb.addEventListener("click",function(){F(!1);rb(1);U()},!1);null!=d&&yb.setAttribute("style",d);null!=l&&(yb.title=l);y.appendChild(yb)}"first"==h&&(Ob=p("button"),ea(Ob,"first","|<","|<",l,"firstlast first"),Ob.addEventListener("click",function(){F(!1);wa(na(0));U()},!1),y.appendChild(Ob));"last"==h&&(Pb=p("button"),ea(Pb,"last",">|",">|",l,"firstlast last"),Pb.addEventListener("click",
function(){F(!1);wa(na(t-1));U()},!1),y.appendChild(Pb));"firstlast"==h&&(d=e.firstlast_labels,T=null!=d?d.split(","):["<<",">>"],Ob=p("button"),ob&&(Ob.className="firstlast"),Ob.innerHTML=T[0],Ob.addEventListener("click",function(){F(!1);wa(na(0));U()},!1),d=Jc+e.firstlast_style,null!=d&&Ob.setAttribute("style",d),null!=l&&(Ob.title=l),y.appendChild(Ob),Pb=p("button"),ob&&(Pb.className="firstlast"),Pb.innerHTML=T[1],Pb.addEventListener("click",function(){F(!1);wa(na(t-1));U()},!1),null!=d&&Pb.setAttribute("style",
d),null!=l&&(Pb.title=l),y.appendChild(Pb));"setspeed"==h?(Qb=p("input"),ob&&(Qb.className="setspeed"),Qb.type="range",Qb.min=gc,Qb.max=Wc,Qb.value=Wc-Ga,null!=l&&(Qb.title=l),d="vertical-align:middle;"+e.setspeed_style,Qb.setAttribute("style",d),Qb.addEventListener("input",function(a){Ga=Wc-parseInt(Qb.value,10)+30;void 0!=Qd&&Qd(Ga);F(!0);U()},!1),y.appendChild(Qb)):"speed"==h&&(d=e.speed_labels,T=null!=d?d.split(","):["-","+"],hc=p("button"),ob&&(hc.className="speed slower"),hc.innerHTML=T[0],
hc.addEventListener("click",function(){Ga+=og;ic.disabled=!1;Ga>Wc&&(Ga=Wc,hc.disabled=!0);void 0!=Qd&&Qd(Ga)},!1),d=Jc+e.speed_style,null!=d&&hc.setAttribute("style",d),null!=l&&(hc.title=l),y.appendChild(hc),ic=p("button"),ob&&(ic.className="speed faster"),ic.innerHTML=T[1],ic.addEventListener("click",function(){Ga-=og;hc.disabled=!1;Ga<gc&&(Ga=gc,ic.disabled=!0);void 0!=Qd&&Qd(Ga)},!1),null!=d&&ic.setAttribute("style",d),null!=l&&(ic.title=l),y.appendChild(ic));"zoom"==h&&(Ka=p("button"),ea(Ka,
"zoom","Zoom","Un-zoom",l,"zoom off"),Ka.addEventListener("click",HAniS.toggleZooming,!1),y.appendChild(Ka),Fa=!1);if("annotate"==h){Ae=p("button");ea(Ae,"annotate","Annotate","Finished",l,"annotate");sa=p("div");sa.setAttribute("style","position:absolute;box-sizing:content-box;height:120px;width:180px;top:20px;left:20px;z-index:15;visibility:hidden;background-color:lightgray;border-width:6px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font:normal normal normal 16px Arial;color:black;");
sa.title="Drag this box around.  Select attributes, then go onto the image and click & drag";id=jd=20;xf=Rb=!1;gi=3;hi=11;kd=Be=0;r=[];sa.style["touch-action"]="none";var Ec=function(a){jd=a.clientX-kd;id=a.clientY-Be;sa.style.top=id+"px";sa.style.left=jd+"px"};sa.addEventListener("mousedown",function(a){if(0!=a.clientX||0!=a.clientY)xf=!0,kd=a.clientX-jd,Be=a.clientY-id},!1);sa.addEventListener("mouseup",function(a){xf=!1},!1);sa.addEventListener("mouseout",function(a){xf&&Ec(a)},!1);sa.addEventListener("mousemove",
function(a){xf&&Ec(a)},!1);window.PointerEvent?(sa.addEventListener("pointerdown",function(a){"mouse"!=a.pointerType&&(kd=a.clientX-jd,Be=a.clientY-id)},!1),sa.addEventListener("pointermove",function(a){"mouse"!=a.pointerType&&(0==kd&&(kd=a.clientX,Be=a.clientY),Ec(a))},!1)):sa.addEventListener("touchmove",function(a){a=a.changedTouches[0];0==kd&&(kd=a.clientX,Be=a.clientY);Ec(a)},!1);Ae.addEventListener("click",function(){if(Rb=!Rb){r=[];jd=u.offsetLeft;id=u.offsetTop;var a=e.annotate_position;null!=
a&&(a=a.split(","),jd+=parseInt(a[0],10),id+=parseInt(a[1],10));sa.style.top=id+"px";sa.style.left=jd+"px";sa.style.visibility="visible";L(Ae,!1,"annotate off");Si=Fa;Fa=!1;null!=Ka&&(Ka.disabled=!0)}else sa.style.visibility="hidden",L(Ae,!0,"annotate on"),Fa=Si,null!=Ka&&(Ka.disabled=!1);fa()},!0);Ce=ii("Color Black White Red Green Blue Yellow Orange Cyan Magenta".split(" "),"black black white red green blue yellow orange cyan magenta".split(" "),function(a){});Kc=ii("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),
[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==De.selectedIndex?hi=Kc.selectedIndex:gi=Kc.selectedIndex});Kc.title="Select width or font size";De=ii("Type Arrow Circle Box Polygon Draw Text Line".split(" "),[-1,0,1,2,3,4,5,6],function(a){6==De.selectedIndex?(Sb.focus(),Sb.select(),Kc.selectedIndex=hi):Kc.selectedIndex=gi;0==Ce.selectedIndex&&(Ce.selectedIndex=2)});d=p("button");d.style.width="70px";d.style.margin="5px";d.innerHTML="Erase";d.title="Erase last item";d.addEventListener("click",
function(){0<r.length&&(r.pop(),fa())},!1);Sb=p("input");Sb.type="text";Sb.style.width="150px";Sb.style.margin="5px";Sb.title="Enter your text here, then click where you want it";Sb.value="Text input";T=e.annotate_defaults;null!=T&&(T=T.split(","),De.selectedIndex=parseInt(T[0],10),1<T.length&&(Ce.selectedIndex=parseInt(T[1],10)),2<T.length&&(Kc.selectedIndex=parseInt(T[2],10)),3<T.length&&(Sb.value=T[3].trim()));T=p("div");T.innerHTML="Annotation Tools";var v=p("div");v.appendChild(De);v.appendChild(Ce);
var n=p("div");n.appendChild(Kc);n.appendChild(d);d=p("div");d.appendChild(Sb);sa.appendChild(T);sa.appendChild(v);sa.appendChild(n);sa.appendChild(d);y.appendChild(Ae);u.appendChild(sa)}"saveall"==h&&(Gg=p("button"),ea(Gg,"saveall","SaveAll","SaveAll",l,"saveall"),ji=e.saveall_prompt,rc=e.saveall_filename,d=e.saveall_list,ki=null==d?["0"]:d.split(","),Gg.addEventListener("click",function(){for(var a=0;a<ki.length;a++)for(var b=parseInt(ki[a],10),d=0;d<ya.length;d++){0===d&&null!=ji&&(rc=window.prompt(ji,
rc),null!=rc&&1>rc.length&&(rc=null));var g=null==rc?"":-1!=rc.indexOf("#")?rc.replace("#",d.toString()):rc+d;var c=document.createElement("a");c.href=0==b?ya[d]:O[d][b-1];c.download=g;c.click()}},!1),y.appendChild(Gg));if("capture"==h){Hg=p("button");ea(Hg,"capture","Capture","Capture",l,"capture");var A=e.capture_prompt;Ig=e.capture_filename;null==Ig&&(Ig="haimage.png");Hg.addEventListener("click",function(){var a=Ig;if(null!=A&&(a=window.prompt(A,a),null==a))return;var b=p("canvas");b.height=sb.height;
b.width=sb.width;var d=b.getContext("2d");ye=!1;fa();d.drawImage(sb,0,0);d.drawImage(zc,0,0);ye=!0;b.toBlob(function(b){var d=URL.createObjectURL(b),g=document.createElement("a");g.href=d;g.download=a;g.click();setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);y.appendChild(Hg)}"show"==h&&(Jg=p("button"),ea(Jg,"show","Show","Show",l,"show"),Kg=e.show_prompt,Ti=e.show_image_file,null==Kg&&(Kg="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),
Jg.addEventListener("click",function(){if(Ti)window.open(ya[m]);else{var a=sb.toDataURL("image/png;base64;");var b=window.open();b.document.write(Kg+"<img src="+a+"></img>")}},!1),y.appendChild(Jg));"toggle"==h&&(Za=[],d=e.toggle_size,null!=d?(d=d.split(","),Rd=parseInt(d[0],10),yf=parseInt(d[1],10),zf=parseInt(d[2],10)):(yf=Rd=10,zf=3),li="red",mi="blue",ni="orange",oi=!1,z(e.toggle_layout_width,"t")&&(oi=!0),d=e.toggle_colors,null!=d&&(d=d.split(","),mi=d[0].trim(),li=d[1].trim(),ni=d[2].trim()),
Eb=p("div"),Eb.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),Eb.style.backgroundColor=y.style.backgroundColor,Eb.align=be,Lg=new PEvs(Eb,HAniS.togdown,HAniS.togup,null,HAniS.togdown,null,null),Lg.setHysteresis(0),ld=p("canvas"),ld.height=2*yf,Mg=ld.getContext("2d"),Eb.appendChild(ld),a?u.insertBefore(Eb,Wa):u.appendChild(Eb),d=e.toggle_onoff,
Af=null,null!=d&&(Af=d.split(",")),Ng=!0,null!=l&&(Eb.title=l));if("overlay"==h||z(h,"menu")){0==Ea&&(w=[]);T=e.overlay_tooltip;d=null;null!=T&&(d=T.split(","));T=e.overlay_radio;v=null;null!=T&&(v=T.split(","));var C=e.overlay_menu_links;n=null;null!=C&&(n=C.split(","));var E=e.overlay_labels_color;C=null;null!=E&&(C=E.split(","));var H=e.overlay_smoothing;E=null;null!=H&&(E=H.split(","));Bf=[];var I=H=cd=!1;z(h,"menu")&&(cd=!0,0<h.indexOf("/on")&&(H=!0),0<h.indexOf("/always")&&(I=!0));0==Ea&&(ue=
[]);var x=e.overlay_caching;h=null;null==x&&(x=e.overlay_static);null!=x&&(h=x.split(","));var K=!0;null!=e.overlay_nonewdiv&&(K=!1);Ea++;for(x=0;x<ec.length;x++){var R=ec[x].trim();Bf[x]=wd;null!=E&&(z(E[x],"t")||z(E[x],"y")?Bf[x]=!0:Bf[x]=!1);if(0==x||0==R.indexOf("/")){0==R.indexOf("/")&&(R=R.substr(1));if(cd){hb[Ea]=p("div");hb[Ea].dropalways=I;var D="menu"+Ea+"_labels_style";hb[Ea].setAttribute("style","text-align:left;display:block;position:absolute;border-style:solid;border-width:2px;background:#ffffff;z-index:99;visibility:"+
(H||I?"visible":"hidden")+";"+(void 0==e[D]?e.overlay_labels_style:e[D]));Og++}else K?(Tb=p("div"),Og++,Tb.align="center",a?u.insertBefore(Tb,Wa):u.appendChild(Tb)):(Tb=p("span"),y.appendChild(Tb));q=e.overlay_labels_style;cd||null==q||Tb.setAttribute("style",q)}if(null==n||null!=n&&n[x]==Ea){D=!1;-1!=R.indexOf("<a href=")&&(D=!0);var G=!1,J=!1,N=!1,M=!1;q=R.length;D||(0<R.indexOf("/on")&&R.indexOf("/on")==q-3&&(G=!0),0<R.indexOf("/always")&&R.indexOf("/always")==q-7&&(J=G=!0),0<R.indexOf("/hidden")&&
(N=!0),0<R.indexOf("/hotspots")&&(M=!0),-1!=R.indexOf("/")&&(R=R.substr(0,R.indexOf("/"))));null!=h?z(h[x],"y")||z(h[x],"t")?ue[x]=!0:ue[x]=!1:ue[x]=!0;w[x]=p("input");w[x].type="checkbox";w[x].value=R;w[x].id=sf+R;w[x].showMe=!(J&N)&!M;var P="vertical-align:middle;";q=e.checkbox_style;null!=q&&(P+=q);w[x].setAttribute("style",P);w[x].checked=G;w[x].restorableState=G;w[x].name=0;w[x].hotspotIndex=M;null!=Ca&&x==tb&&w[x].checked&&(Ca.disabled=!1);null!=Bc&&!Bc[x]&&G&&(xd=!1);w[x].addEventListener("click",
HAniS.overClick,!1);null!=T&&(q=v[x].indexOf("/"),-1!=q&&(w[x].name=v[x].substr(q+1).trim()),z(v[x],"t")&&(w[x].type="radio",-1==q&&(w[x].name="all")));w[x].isGhost=!0;J||N||(null!=d&&(w[x].title=d[x]),J=p("label"),J.htmlFor=sf+R,null!=d&&(J.title=d[x]),J.innerHTML=R,J.name=w[x].name,R="vertical-align:middle;",null!=C&&(R=R+"color:"+C[x]+";"),J.setAttribute("style",R),R=p("span"),D||R.appendChild(w[x]),R.appendChild(J),cd?(R.setAttribute("style","display:block;margin-right:5px;"),hb[Ea].appendChild(R)):
(D="10",null!=Ye&&(D=10+Ye[x]),R.setAttribute("style","margin-left:"+D+"px;"),Tb.appendChild(R)),w[x].isGhost=!1)}}cd&&(md[Ea]=p("button"),ea(md[Ea],"menu"+Ea,"Show Overlay Menu","Hide Menu",l,"menu off"),md[Ea].menuInx=Ea,md[Ea].addEventListener("click",function(a){if("hidden"===hb[this.menuInx].style.visibility){for(a=1;a<hb.length;a++)hb[a].dropalways||"visible"!=hb[a].style.visibility||(hb[md[a].menuInx].style.visibility="hidden",L(md[a],!0,"menu off"));hb[this.menuInx].style.visibility="visible";
L(this,!1,"menu on")}else hb[this.menuInx].style.visibility="hidden",L(this,!0,"menu off")},!1),hb[Ea].dropalways||y.appendChild(md[Ea]),u.insertBefore(hb[Ea],Wa));if(null==fc)for(fc=Array(ec.length),x=0;x<ec.length;x++)fc[x]=0;else for(x=0;x<ec.length;x++)Ib(x)}}za=!0;qf=null;q=e.start_looping;null!=q&&(d=q.split(","),z(d[0],"f")&&(za=!1),1<d.length&&(Lb=parseInt(d[1],10)-1,isNaN(Lb)&&(Lb=0),m=Lb),2<d.length&&(z(d[2],"t")&&(qf=!0),z(d[2],"f")&&(qf=!1)));F(za)}function Ib(b){var a;if(0>fc[b]){var g=
!1;for(a=0;a<ec.length;a++)fc[a]!=-fc[b]||g||(g=w[a].checked);w[b].checked=g}}function Xb(b){0==eb&&(fb=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var a=b[4].trim(),g=b[4].indexOf("/"),d=b[4].indexOf("?"),c=-1,e=-1;-1!=g&&(c=parseInt(b[4].substring(g+1),10)-1,a=a.substring(0,g));-1!=d&&(e=parseInt(b[4].substring(d+1),10)-1,d<g||-1==g)&&(a=a.substring(0,d));fb[eb]=new mb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),a.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),
c,e,8<=b.length?b[7].trim():null,9==b.length?b[8].trim():null);eb+=1}function Yd(b){0==of&&(Ya=[],va=null);var a=b.substr(b.indexOf("=")+1).trim().split("(");b=a[0].split(",");var g=b[0].trim();0==g.indexOf("0x")&&(g="#"+g.substring(2));Ya[of]=new xc(g,b[1].trim(),b[2].trim(),b[3].trim(),a[1].trim());of+=1}function Oa(b){0==Ab&&(Qa=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");Qa[Ab]=new Yb(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");
Ab+=1}function xc(b,a,g,d,c){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=a;this.value=g;this.tip=d;this.poly=c;b=c.split(",");this.xy=[];this.ymin=this.xmin=9999;for(a=this.ymax=this.xmax=0;a<b.length;a++)this.xy[a]=parseInt(b[a].trim(),10),0==a%2?(this.xy[a]<this.xmin&&(this.xmin=this.xy[a]),this.xy[a]>this.xmax&&(this.xmax=this.xy[a])):(this.xy[a]<this.ymin&&(this.ymin=
this.xy[a]),this.xy[a]>this.ymax&&(this.ymax=this.xy[a]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=p("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(a=2;a<this.xy.length;a+=2)this.ctx.lineTo(this.xy[a]-this.xmin,this.xy[a+1]-this.ymin);
this.ctx.closePath();this.ctx.fill()}function Yb(b,a,g,d,c){this.overlay=b;this.color=a;this.action=g;this.value=d;this.tip=c}function mb(b,a,g,d,c,e,f,l,k,h,q){this.x0=b;this.y0=a;this.icon=null;this.isIcon=!1;if("icon"==g)this.icon=new Image,this.icon.hotspot=this,Pg=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=
this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.zoomme=this.fromfile=this.anim=!1,this.icon.gotit=!1,this.icon.src=d.trim();else if("sprite"==g||"spritefn"===g){this.x0=b;this.y0=a;this.inx=parseInt(d,10)-1;Ee=!1;oh?null!=pa&&(-1!=ad?this.inx>=ad&&this.inx<=ad+pa.length&&(Ee=!0):"spritefn"===g&&(Ee=!0)):Ee=!0;if(Ee){-1!=ad&&(this.inx-=ad);if(this.inx>=pa.length)return null;this.x1=pa[this.inx].width+b;this.y1=pa[this.inx].height+a;this.width=
pa[this.inx].width;this.height=pa[this.inx].height;this.w2=this.width/2;this.h2=this.height/2;this.origY=this.origX=0;this.icon=pa[this.inx].cloneNode();this.anim=pa[this.inx].anim;this.fromfile=pa[this.inx].fromfile;this.zoomme=pa[this.inx].zoomme;this.anim&&(this.icon.setAttribute("style","position:absolute;top:0px;left:0px;visibility:hidden;"),Gc.appendChild(this.icon))}else this.x1=cc[this.inx]+b,this.y1=dc[this.inx]+a,this.width=cc[this.inx],this.height=dc[this.inx],this.w2=cc[this.inx]/2,this.h2=
dc[this.inx]/2,this.origX=$f[this.inx],this.origY=ag[this.inx],this.icon=Zf,this.zoomme=this.fromfile=this.anim=!1;Pg=this.isIcon=!0;this.icon.gotit=!0}else this.width=parseInt(g,10),this.height=parseInt(d,10),this.w2=this.width/2,this.h2=this.height/2,Yf&&(this.x0=b-this.w2,this.y0=a-this.h2),this.x1=this.width+this.x0,this.y1=this.height+this.y0;this.pan=c;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=e;this.value=f;this.overlay=l;this.frame=k;this.tip=h;this.target=q}function Zb(){if(Sd&&
!Hd){ca=-1;for(var b=0;b<ta.length;b++)C>=ta[b]&&(ca=b)}}function qb(){null!=kc?Ba=kc.toLatLon(ja,ka):null!=tg?(Ba[0]=tg+(Mi-tg)*ka/ra,Ba[1]=ug+(vg-ug)*ja/qa):(Ba[0]=Math.round(ja),Ba[1]=Math.round(ka))}function rd(b,a){"popup"==b.action?(null!=Qg&&Qg.close(),Qg=window.open("","HAniSPopup","scrollbars=yes,width="+Ph+",height="+Oh),Qg.document.write(Nh+b.value+"</div>")):"link"==b.action?(a=b.value,qb(),a=a.replace("%LATITUDE%",Ba[0].toFixed(4)),a=a.replace("%LONGITUDE%",Ba[1].toFixed(4)),a=a.replace("%FRAMENUMBER%",
m+1),a=a.replace("%FRAMENUMBERINDEX%",cg[m]),window.open(a,b.target?b.target:"_blank","")):"fof"==b.action&&(ia=Fh,HAniS.resetZoom(),HAniS.newFOF(b.value,!0),wc(a))}function Mc(){var b=Kh?Ed/C:0;G+b<Ed&&(G=Ed-b);b=Lh?Fd/C:0;G+Ia-b>qa-Fd&&(G=qa-Ia+b-Fd);b=Jh?Dd/K:0;J+b<Dd&&(J=Dd-b);b=Ih?Cd/K:0;J+Ha-b>ra-Cd&&(J=ra-Ha-Cd+b);J=Math.round(J);G=Math.round(G)}function Zd(b){var a=!1;b?Hd?(ca--,0>ca?a=!0:(C=ta[ca],K=ta[ca])):(C-=.1*Gd/H,K-=.1*Gd/I):Hd?(ca++,ca>=ta.length?(ca--,ng&&(a=!0)):(C=ta[ca],K=ta[ca])):
(!ng||C!==Vc&&K!==Vc||(a=!0),C+=.1*Gd/H,K+=.1*Gd/I,C>Vc&&(C=Vc),K>Vc&&(K=Vc));a||C<=pf||K<=Cf?(C=pf,K=Cf,ca=-1,ja=n,ka=A,J=G=0,Ha=ra,Ia=qa,Ed=Fd=Dd=Cd=0,Ld&&(pb=!0)):(Cd=jg,Dd=kg,Fd=mg,Ed=lg,G=ja-n/C,J=ka-A/K,Ha=Math.floor(ra/K),Ia=Math.floor(qa/C),Mc(),Ld&&(pb=!1));Zb();void 0!=Td&&Td(["zoom",C,K,ja,ka,n,A,G,J,Ia,Ha])}function $b(){Df=0;Ub=Array(2);Fb=Array(2);Ud=Array(2);$a=0;Ad=null;wa(na(0))}function F(b){Da=!b;HAniS.toggleIsLooping()}function $d(b,a,g,d,c,e){oe.clearRect(0,0,M,P);oe.imageSmoothingEnabled=
wd;D.imageSmoothingEnabled=wd;oe.drawImage(b,a,g,d,c,0,0,M,P);pi=oe.getImageData(0,0,M,P);nd=pi.data;Rg=bb[e];Sg=cb[e];Tg=db[e];Ug=le[e];Ui=4*M*P;for(sc=0;sc<Ui;sc+=4)ib=nd[sc],ib===nd[sc+1]&&ib===nd[sc+2]&&(nd[sc]=Rg[ib],nd[sc+1]=Sg[ib],nd[sc+2]=Tg[ib],nd[sc+3]=Ug[ib]);oe.putImageData(pi,0,0);D.drawImage(hf,0,0,M,P)}function L(b,a,c){null!=b&&(a?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),
ob&&(b.className=c))}function Ja(b,a){if(!(b>=t)&&(-2==Za[b]&&(a=-2),Za[b]=a,zg&&1==a&&(La.value=b+1,ze.innerHTML=wf.replace("*",b+1)),Ng)){b=qi+b*(Rd+zf);var c=ni;0==a?c=mi:-1==a?c=li:-2==a&&(c=qh);Mg.fillStyle=c;Mg.fillRect(b,yf/2,Rd,yf)}}function Le(b,a){Ng&&(ld.width=oi?parseInt(u.style.width,10):M,Mg.clearRect(0,0,ld.width,ld.height),qi=ld.width/2-b*(Rd+zf)/2);for(var c=0;c<b;c++)a?-1!=ge?Ja(c,-2):null!=Af&&"n"==Af[c].toLowerCase().trim()?Ja(c,-1):Ja(c,0):Ja(c,Za[c])}function wa(b){Ja(m,0);m=
b;Ja(m,1);null!=Ua&&null!=gb&&null!=gb[m]&&(Ua.innerHTML=gb[m]);void 0!=Ef&&Ef(m)}function na(b){b>=t&&(b=t-1);if(0<=Za[b])return b;var a=-1,c=b;0==c&&(a=1);for(var d=0;d<t-1;d++)if(c+=a,0<=Za[c])return c;return b}function rb(b){Ja(m,0);var a=b;do 0<a?(a=na(t-1),m+=1,m>a&&(Fe&&Da?(m=a,b=-b,Cb&&F(!1)):Cb?(m=a,F(!1)):m=na(0))):(a=na(0),--m,m<a&&(Fe&&Da?(m=a,b=-b,Cb&&F(!1)):Cb?(m=a,F(!1)):m=na(t-1))),a=b;while(0>Za[m]);Cb=Ff;void 0!=Ef&&Ef(m);we=a;Ja(m,1);null!=Ua&&null!=gb&&null!=gb[m]&&(Ua.innerHTML=
gb[m])}function nb(b,a,c,d,e,f,k){this.bg=b;null!=b&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=a;null!=a&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=c;this.fontHeight=Math.round(1.1*parseInt(c,10));this.scolor=d;null!=d&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=e;this.sxoff=f;this.syoff=k}function Va(b,a,c,d,e){k.globalAlpha=1;k.font=b.font;var g=b.fontHeight;c=c-g-6;var f=k.measureText(d).width;1==e&&
(a-=f);0==e&&(a-=f/2);5>a&&(a=5);5>c&&(c=5);c+g+3>P&&(c=P-g-6);a+3+f>M&&(a=M-f-6);k.save();k.beginPath();k.fillStyle=b.bg;null!=b.scolor&&(k.shadowColor=b.scolor,k.shadowBlur=b.sblur,k.shadowOffsetX=b.sxoff,k.shadowOffsetY=b.syoff);Gf=a-3;Vg=c;ri=f+6;Wg=g+6;k.fillRect(Gf,Vg,ri,Wg);k.closePath();k.restore();k.textBaseline="bottom";k.fillStyle=b.fg;k.fillText(d,a,c+g+3)}function fa(){k.clearRect(0,0,M,P);Xg=!1;if(jb){k.beginPath();k.lineWidth=2;k.strokeStyle="white";var b=$a;1<b&&(b=2);for(var a=0;a<
b;a++)1<$a&&(k.moveTo(Ub[0]/H,Fb[0]/I),k.lineTo(Ub[1]/H,Fb[1]/I)),k.moveTo(Ub[a]/H-15,Fb[a]/I),k.lineTo(Ub[a]/H+15,Fb[a]/I),k.moveTo(Ub[a]/H,Fb[a]/I-15),k.lineTo(Ub[a]/H,Fb[a]/I+15);k.closePath();k.stroke();if(3==$a){var c=Z,d=W;k.moveTo(c,d);k.fillStyle=Cc;k.fillRect(c-2,d-2,5,5);b=Vd;a=Math.round(c+Hf/H*Ge*(Vd-Ud[1]));for(var e=Math.round(d+He/I*Ge*(Vd-Ud[1])),f=0;300>f;f++){k.beginPath();k.lineWidth=1;k.strokeStyle=Cc;k.moveTo(c,d);k.lineTo(a,e);k.stroke();k.beginPath();k.lineWidth=3;k.rect(a-
2,e-2,5,5);k.stroke();if(3>a||a+3>M||3>e||e+3>P)break;d=lc+b;d=100*Math.floor(d/60)+d%60;d%=2400;Ah?(c="AM",1200<=d?(1300<=d&&(d-=1200),c="PM"):100>d&&(d+=1200),c=Math.floor(d/100)+":"+Math.floor(Math.floor(d%100)/10)+Math.floor(d%10)+" "+c):(c=d+" ",1E3>d&&(c="0"+d),100>d&&(c="00"+d),10>d&&(c="000"+d));d=0;Math.abs(Yg)<zd+5&&(d=45*Vb);var h=e;0>si*Yg&&0==d&&(h=e+zd);k.font=ie;c=c+" "+zh;var l=k.measureText(c).width;k.fillStyle=he;0===d?(k.fillRect(a+2,h-zd-2+d,l+4,zd+3),k.fillStyle=Cc,k.textBaseline=
"bottom",k.fillText(c,a+5,h)):(k.save(),k.translate(a+5,e),k.rotate(d),k.fillRect(2,-2,l+4,zd+3),k.fillStyle=Cc,k.textBaseline="bottom",k.fillText(c,5,zd),k.restore());c=a;d=e;a=Math.round(c+Ge*si);e=Math.round(d+Ge*Yg);b+=da}}null!=Ad&&Va(fg,Vi,Wi,Ad,0);ye&&(Va(Hi,9999,Vh,Uh[Df],0),ti=Gf,ui=Vg,vi=Vg+Wg)}if(Db){ye&&(0==Pd?Va(ei,9999,10,cf[0],0):(Va(Ri,10,10,cf[1],0),Xi=Gf+ri,Va(ei,9999,10,cf[2],0)),Yi=Gf,Zi=Wg);k.beginPath();k.lineWidth=2;k.strokeStyle=Wh;for(b=0;b<ua.length;b+=2)0==b?k.moveTo(ua[b]/
H,ua[b+1]/I):k.lineTo(ua[b]/H,ua[b+1]/I);df&4<ua.length&&k.lineTo(ua[0]/H,ua[1]/I);k.stroke();for(b=0;b<ua.length;b+=2)k.beginPath(),k.rect(ua[b]/H-2,ua[b+1]/I-2,5,5),k.stroke()}if(Rb)for(b=0;b<r.length;b++){c=r[b].type;k.beginPath();k.strokeStyle=r[b].color;k.lineWidth=r[b].width;if("0"==c||"6"==c)a=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),e=r[b].x+r[b].width*Math.sin(a),f=r[b].y+r[b].width*Math.cos(a),k.beginPath(),k.moveTo(e,f),k.lineTo(r[b].xe,r[b].ye),"0"==c&&(c=12+r[b].width/5,d=30*Vb,k.moveTo(e+
c*Math.sin(a-d),f+c*Math.cos(a-d)),k.lineTo(e,f),k.lineTo(e+c*Math.sin(a+d),f+c*Math.cos(a+d)));else if("1"==c)k.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==c)k.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);else if("3"==c){k.moveTo(r[b].xp[0],r[b].yp[0]);for(e=1;e<r[b].xp.length;e++)k.lineTo(r[b].xp[e],r[b].yp[e]);k.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==c)for(k.moveTo(r[b].xp[0],r[b].yp[0]),e=1;e<r[b].xp.length;e++)k.lineTo(r[b].xp[e],r[b].yp[e]);else"5"==c&&(k.fillStyle=
r[b].color,k.font=r[b].width+"pt arial",a=k.measureText(r[b].text).width,k.fillText(r[b].text,r[b].x-a/2,r[b].y+r[b].width/2));k.stroke()}gd&&(Z=oa.getX(),n=Z*H,ja=G+n/C,W=oa.getY(),A=W*I,ka=J+A/K,k.beginPath(),k.strokeStyle=ih,k.lineWidth=3,k.moveTo(Zg/H,$g/I),k.lineTo(If/H,Jf/I),k.stroke(),k.closePath(),qb(),ud?(od=Vb*Wd[0],pd=Vb*Ba[0],Ie=Vb*Wd[1],Je=Vb*Ba[1],ah=Math.pow(Math.sin((pd-od)/2),2)+Math.cos(od)*Math.cos(pd)*Math.pow(Math.sin((Je-Ie)/2),2),ah=12742.02*Te*Math.asin(Math.min(1,Math.sqrt(ah))),
b=" "+ah.toFixed(Vf)+" "+vd+" ",ce&&(a=z(ce,"t")?(Math.atan2(Math.sin(Je-Ie)*Math.cos(pd),Math.cos(od)*Math.sin(pd)-Math.sin(od)*Math.cos(pd)*Math.cos(Je-Ie))/Vb+360)%360:(Math.atan2(Math.sin(Ie-Je)*Math.cos(od),Math.cos(pd)*Math.sin(od)-Math.sin(pd)*Math.cos(od)*Math.cos(Ie-Je))/Vb+360)%360,b=b+" ("+a.toFixed(0)+"\u00b0)")):(a=Oc*(Wd[0]-Ba[0]),e=Re*(Wd[1]-Ba[1]),b=" "+Math.sqrt(a*a+e*e).toFixed(Vf)+" "+vd+" ",ce&&(a=Math.atan2(-a,e)/Vb,0>a&&(a+=360),z(ce,"f")&&(a+=180),360<a&&(a-=360),b=b+" ("+a.toFixed(0)+
"\u00b0)")),Va(Fi,If/H+10,Jf/I,b,-1));Nb&&Va(Eh,wi,xi,yi,-1);if(bc||Nd||We)if(Z=oa.getX(),n=Z*H,W=oa.getY(),A=W*I,0<=n&&0<=A){ja=G+n/C;ka=J+A/K;if(Nd){qb();b=Ba[1];ud&&180<b&&(b-=360);ud&&360<b&&(b-=360);$i=Oe+Ba[0].toFixed(Sf)+"  "+Pe+b.toFixed(Sf);b=W;if(gd||Nb)b=W+hh.fontHeight+6;Va(hh,Z+10,b,$i,-1)}if(We)for(k.fillStyle=mh,b=0;b<eb;b++)if(a=fb[b],a.isPan){if(ja>=a.x0&&ja<=a.x1&&ka>=a.y0&&ka<=a.y1){(-1===a.overlay||w[a.overlay].checked)&&k.fillRect((a.x0-G)*C,(a.y0-J)*K,a.width*C,a.height*K);break}}else if(n>
a.x0&&n<a.x1&&A>a.y0&&A<a.y1){(-1===a.overlay||w[a.overlay].checked)&&k.fillRect(a.x0,a.y0,a.width,a.height);break}if(bc&&Yc&&fd)if(ja=Math.round(ja),ka=Math.round(ka),Wf)ab.clearRect(0,0,1,1),ab.drawImage(Ra[m],ja,ka,1,1,0,0,1,1),ba=ab.getImageData(0,0,1,1).data,X=0,ae(!1);else for(a=0;a<Y;a++)if(b=Y-a-1,N[m][b].gotit&&w[b].checked&&(b==tb||null!=Ac[b]&&0<=Ac[b])){ab.clearRect(0,0,1,1);b==tb?ab.drawImage(nc[m],ja,ka,1,1,0,0,1,1):ab.drawImage(N[m][b],ja,ka,1,1,0,0,1,1);ba=ab.getImageData(0,0,1,1).data;
X=Ac[b];null!=X&&ae(b==tb||Zh);break}}!pb||jb||ac||bc||null==va||(k.drawImage(va.can,0,0,va.width,va.height,va.xmin/H,va.ymin/I,va.width/H,va.height/I),Va(Eh,(va.xmin+va.xmax)/2/H,(va.ymin+va.ymax)/2/I,va.tip,0),Xg=!0)}function ae(b){Kf=999;tc=jh;var a=zb[X].length-1;if(0==ba[3])tc=gf[X];else{if(kh)uc=ba[0];else if(b)bh=0,uc=ba[0],Kf=0;else for(var c=0;c<a;c++)vc[0]=ba[0]-bb[X][c],0>vc[0]*(bb[X][c+1]-ba[0]-1)||(vc[1]=ba[1]-cb[X][c],0>vc[1]*(cb[X][c+1]-ba[1]-1)||(vc[2]=ba[2]-db[X][c],0>vc[2]*(db[X][c+
1]-ba[2]-1)||(Xd=sg[X][c],ch=vc[Xd]/bd[X][c][Xd],zi=Math.abs(vc[Ai[Xd]]-ch*bd[X][c][Ai[Xd]])+Math.abs(vc[Bi[Xd]]-ch*bd[X][c][Bi[Xd]]),zi<Kf&&(uc=c,Kf=zi,bh=ch))));if(999>Kf)tc=$c[X][uc],-1!=jc[X][uc]&&(Ci=zb[X][uc],0!=bh&&(Ci+=bh*(zb[X][uc+1]-zb[X][uc])),tc=tc+" "+Ci.toFixed(jc[X][uc])+" "+Zc[X][uc]);else if(b||0<de){var d=-1;if(b)d=ba[0];else for(c=0;c<a;c++)if(Math.abs(ba[0]-bb[X][c])<de&&Math.abs(ba[1]-cb[X][c])<de&&Math.abs(ba[2]-db[X][c])<de){d=c;break}-1!=d&&(tc=$c[X][d],-1!=jc[X][d]&&(tc=tc+
" "+zb[X][d].toFixed(jc[X][d])+" "+Zc[X][d]))}}"hide"!=tc&&Va(Gi,Z-10,W,tc,1)}function U(){if(fd)try{D.clearRect(0,0,M,P);D.globalAlpha=1;if(!Mh)if(Sd&&null!=oc&&0<=ca&&oc[ca].gotit)D.drawImage(oc[ca],G*ta[ca],J*ta[ca],Ia*ta[ca],Ha*ta[ca],0,0,M,P);else if(Ra[m].gotit&&(null!=bg?$d(Ra[m],G,J,Ia,Ha,bg):D.drawImage(Ra[m],G,J,Ia,Ha,0,0,M,P)),null!=Pa&&(D.globalAlpha=1,Ra[m].gotit))for(var b=0;b<Pa.length;b+=4)D.drawImage(Ra[m],Pa[b],Pa[b+1],Pa[b+2],Pa[b+3],Pa[b]/H,Pa[b+1]/I,Pa[b+2]/H,Pa[b+3]/I);if(0<
Y){for(b=0;b<Y;b++){var a=null!=Sc?Sc[b]:b;D.imageSmoothingEnabled=Bf[a];!dg[a]&&w[a].checked&&w[a].showMe&&(null!=Ze&&(D.globalAlpha=Ze[a]),Sd&&0<=ca&&null!=Aa&&void 0!=Aa[a]&&Aa[a][ca][m].gotit?D.drawImage(Aa[a][ca][m],G*ta[ca],J*ta[ca],Ia*ta[ca],Ha*ta[ca],0,0,M,P):N[m][a].gotit&&(null==Tc||1===Tc[a]?null!=Qc&&0<=Qc[a]?$d(N[m][a],G,J,Ia,Ha,Qc[a]):D.drawImage(N[m][a],G,J,Ia,Ha,0,0,M,P):0===Tc[a]&&D.drawImage(N[m][a],0,0,qa,ra,0,0,M,P)))}if(null!=ub)for(D.globalAlpha=1,b=0;b<Y;b++)if(a=null!=Sc?Sc[b]:
b,N[m][a].gotit&&(yh[a]||w[a].checked)&&ub[a])for(var c=0;c<la[a].length;c++)D.drawImage(null!=N[m][a].origImage?N[m][a].origImage:N[m][a],la[a][c][0],la[a][c][1],la[a][c][2],la[a][c][3],la[a][c][4]/H,la[a][c][5]/I,la[a][c][2]/H,la[a][c][3]/I)}bc&&fa();di&&Nc();if(Pg)for(D.globalAlpha=1,a=0;a<eb;a++)if(null!=fb[a]){var d=fb[a];null!=d.icon&&(d.icon.style.visibility="hidden");if((-1==d.frame||d.frame==m)&&null!=d.icon&&d.icon.gotit&&(-1==d.overlay||-1!=d.overlay&&w[d.overlay].checked)){if(d.isPan){d.zoomme&&
(d.icon.style.width=Math.round(d.width*C)+"px",d.icon.style.height=Math.round(d.height*K)+"px",d.w2=Math.round(d.width*C/2),d.h2=Math.round(d.height*K/2));var e=Math.round(((d.x0-G)*C-d.w2)/H);var f=Math.round(((d.y0-J)*K-d.h2)/I);if(d.anim){if(0>=e+d.icon.width||e>=qa||0>=f+d.icon.height||f>=ra)continue;d.icon.style.top=f+"px";d.icon.style.left=e+"px"}else D.drawImage(d.icon,d.origX,d.origY,d.width,d.height,e,f,d.width/H,d.height/I)}else D.drawImage(d.icon,d.origX,d.origY,d.width,d.height,d.x0/H,
d.y0/I,d.width/H,d.height/I);d.icon.style.visibility="visible"}}Lf&&(Mf.addFrame(D,{copy:!0,delay:Di}),m==na(t-1)&&(Lf=!1,F(za),Mf.render()))}catch(Q){ha("Error:"+Q)}}function xa(b,a,c){!bf||c>=a||(D.save(),D.fillStyle="blue",D.strokeStyle="white",D.lineWidth=3,D.strokeRect(kf,lf,200,18),D.fillRect(kf,lf,c/a*200,18),a=D.measureText(b).width,D.fillStyle="orange",D.font="14px arial",D.fillText(b,kf+100-a/2,lf+14),D.restore())}function Nc(){bf&&mc>Sa?xa("Loading Images",mc,Sa):(di=!1,Rf&&(yc.style.visibility=
"hidden"));Sa>=mc&&(Da||wa(na(m)),null!=td&&(Ca.value=td,HAniS.doEnhance(null),td=null),void 0!=mf&&mf(!0),null!=Bb&&(Bb.disabled=!1),null!=Mb&&(Mb.disabled=!1))}function ha(b){if(Me&&Qf&&!Qf.closed)try{Qf.document.write(b+"<br>")}catch(a){}}function Qi(){Da&&rb(we);Di=m==na(t-1)?lh+Ga:Ga;U();setTimeout(function(){hj(Qi)},Di)}function Nf(b){for(;-180>b;)b+=360;for(;180<b;)b-=360;return b}function fj(){var b,a,c,d,e,f,k,l,h=Math.PI/180;this.init=function(d){for(var c=[],g=1;g<d.length;g++)c[g]=parseFloat(d[g]);
a=c[1];b=c[4]/c[5];e=c[6];f=c[7];d=this.toXY(c[2],c[3]);e=d[0];f=d[1]};this.toXY=function(g,B){c=b*Nf(B-a)*h-e;d=-b*g*h-f;return[c,d]};this.toLatLon=function(d,c){k=-(c+f)/b/h;l=Nf((d+e)/b/h+a);return[k,l]}}function ej(){var b,a,c,d,e,f,k,l,h,q,p,t,r,m,v,n,z,y,A,x,u,E,C,H,D,w,F,I,K,J,L,G=Math.PI/180;this.init=function(d){for(var c=[],g=1;g<d.length;g++)c[g]=parseFloat(d[g]);b=c[1];a=c[2];x=0==c[8]?!1:!0;u=c[6];E=u*u;C=E*E;H=C*E;D=C*C;k=c[5]/c[7];L=c[7];x?(l=Math.cos(G*b),h=Math.sin(G*b)):(l=Math.cos(-b*
G),h=Math.sin(-b*G));z=l/Math.sqrt(1-E*h*h);A=(1-u*h)/(1+u*h);n=x?Math.tan(Math.PI/4-b*G/2)/Math.pow(A,u/2):Math.tan(Math.PI/4- -b*G/2)/Math.pow(A,u/2);m=c[9];v=c[10];d=this.toXY(c[3],c[4]);m=d[0];v=d[1]};this.toXY=function(g,B){x?(e=G*g,f=G*(B-a)):(e=G*-g,f=G*(a-B));A=(1-u*Math.sin(e))/(1+u*Math.sin(e));y=Math.tan(Math.PI/4-e/2)/Math.pow(A,u/2);w=90!=b&&-90!=b?k*z*y/n:2*k*L*y/Math.sqrt(Math.pow(1+u,1+u)*Math.pow(1-u,1-u));c=w*Math.sin(f);d=w*Math.cos(f);x||(c=-c,d=-d);q=c-m;p=d-v;return[q,p]};this.toLatLon=
function(g,f){c=g+m;d=f+v;w=Math.sqrt(c*c+d*d);y=90==b||-90==b?w*Math.sqrt(Math.pow(1+u,1+u)*Math.pow(1-u,1-u))/(2*k*L):w*n/(k*z);F=Math.PI/2-2*Math.atan(y);I=Math.sin(2*F);K=Math.sin(4*F);J=Math.sin(6*F);e=F+I*E/2+5*I*C/24+I*H/12+13*I*D/360+7*K*C/48+29*K*H/240+811*K*D/11520+7*J*H/120+81*J*D/1120+4279*Math.sin(8*F)*D/161280;x?(t=e/G,r=Math.atan2(c,d)/G+a):(t=-e/G,r=-Math.atan2(-c,-d)/G+a);return[t,Nf(r)]}}function gj(){var b,a,c,d,e,f,h,l,k,q,p,t,u,r,m,v,n,z,y,x,A,E,C,w,D,F,H,I,G,K,J,L,N,M,P,O=Math.PI/
180;this.init=function(d){for(var g=[],e=1;e<d.length;e++)g[e]=parseFloat(d[e]);b=g[1];a=g[2];c=g[3];w=g[7];D=w*w;F=D*D;H=F*D;I=F*F;l=g[6]/g[8];k=Math.cos(O*b);q=Math.cos(O*a);t=Math.sin(b*O);p=Math.sin(a*O);A=k/Math.sqrt(1-D*t*t);E=q/Math.sqrt(1-D*p*p);y=Math.sqrt((1-t)/(1+t)*Math.pow((1+w*t)/(1-w*t),w));x=Math.sqrt((1-p)/(1+p)*Math.pow((1+w*p)/(1-w*p),w));J=(Math.log(A)-Math.log(E))/(Math.log(y)-Math.log(x));L=A/(J*Math.pow(y,J));M=l*L*Math.pow(y,J);n=g[9];z=g[10];d=this.toXY(g[4],g[5]);n=d[0];
z=d[1]};this.toXY=function(a,b){f=O*a;h=O*Nf(b-c);P=Math.sin(f);C=Math.sqrt((1-P)/(1+P)*Math.pow((1+w*P)/(1-w*P),w));K=l*L*Math.pow(C,J);N=J*h;d=K*Math.sin(N);e=M+K*Math.cos(N);u=d-n;r=e-z;return[u,r]};this.toLatLon=function(a,b){d=a+n;e=b+z;K=Math.abs(J)/J*Math.sqrt(d*d+(M-e)*(M-e));C=Math.pow(K/(l*L),1/J);G=Math.PI/2-2*Math.atan(C);N=0>J?Math.atan(-d/(e-M)):Math.atan(d/(M-e));h=N/J;f=G+(D/2+5/24*F+H/12+13/360*I)*Math.sin(2*G)+(7/48*F+29/240*H+811/11520*I)*Math.sin(6*G)+(7/120*H+81/1120*I)*Math.sin(6*
G)+4279/161280*I*Math.sin(8*G);m=f/O;v=Nf(c-h/O);return[m,v]}}var ph,P,M,ra,qa,pe,jf,H,I,Xh,Yh,Ob,Pb,yc,Rf,oa,Me,Qg,Qf,Jc,dh,fe,u,y,rf,tf,Wa,sf,Gc,qe,aj,bj,sb,D,ab,zc,k,ne,Cg,Uc,gg,af,ci,hg,Hc,t,ya,Qh,hb,cd,Ea,md,Y,dg,ec,Sc,O,Ic,fc,Bd,ia,Fh,Ra,N,xg,Ni,$h,w,Ze,ue,Nb,yi,wi,xi,yd,Jb,rh,V,sh,me,yg,Z,W,n,A,ja,ka,Ia,Ha,G,J,ye,ob,Lb,Pi,Da,za,qf,m,Ef,we,Fe,Td,Fc,Jd=!0,Xe,uf,Fg,Eg,Qe,Ne,e,Ga,gc,Wc,Qd,mf,og,lh,Di,wd,nh,Bf,Ca,Kd,Rc,tb,td,Xa,nc,dd,te,Ag,nf,bg,hf,oe,pi,nd,ib,Rg,Sg,Tg,Ug,Ui,sc,Qc,Za,Rd,yf,zf,oi,
Eb,qi,Lg,eh,li,mi,ni,ge,qh,fb,eb,Pg,ig,We,Yf,mh,rg,pa,ad,Ee,ai,Ab,Qa,ba,fh,Ya,of,pb,Ld,Bg,se,va,Xg,Bc,xd,ta,ca,oc,ed,Aa,Ta,Sd,gb,Ua,Lc,Ng,Af,ld,Mg,fd,sd,Kb,yb,xb,Qb,ic,hc,Ye,Bb,Lf,Mf,Mb,Id,hd,Db,Pd,cf,pg,df,ff,Wh,ua,Ri,ei,Yi,Xi,Zi,pc,jb,$a,Ub,Fb,Ud,ti,Uh,ui,vi,Vh,Hi,wb,Ge,Hf,He,Ei,Vb,ke,wg,si,Yg,Vd,da,Df,lc,$e,zh,Cc,he,ie,zd,Ah,Bh,Ti,Jg,Kg,Hg,Ig,Ae,r,Gg,ji,rc,ki,sa,Rb,kd,Be,jd,id,xf,Si,De,Ce,Kc,Sb,gi,hi,Ka,Hh,Gh,Gd,C,K,pf,Cf,Th,Dc,je,Sh,Rh,Fa,Vc,Hd,Of,ng,th=!1,uh,vh,wh,eg,xh,Cb,Ff,vf,fi,ve,xe,La,
wf,ze,zg,qc,ac,Zg,$g,Vf,Se,ud,Gf,Vg,ri,Wg,bi=!0,re,gh,If,Jf,Fi,ih,Uf,Ma,Tf,Ue,gd,Oc,Re,vd,ce,od,pd,Ie,Je,ah,Te,Eh,cg,Md,Nd,Sf,Oe,Pe,hh,kc,Ba,Wd,$i,tg,ug,Mi,vg,Pa,Tb,Og,Tc,ub,la,yh,Dg,ef,Xc,Nh,Ph,Oh,Ac,bc,Od,Ve,Yc,Zc,$c,jc,Xd,Kf,Gi,jh,de,kh,Wf,fg,Ch,Dh,Ad,Vi,Wi,uc,bh,ch,Ai,Bi,vc,X,zi,tc,Ci,zb,v,bd,Zh,bb,cb,db,le,sg,gf,cj,ee,Xf,Pc,bf,Zf,$f,ag,cc,dc,oh,di,kf,lf,Sa,mc,Cd,Mh,jg,Dd,kg,Ed,lg,Ih,Jh,Lh,Kh,Fd,mg,be,vb,ij="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),hj=window.requestAnimationFrame||
window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},p=function(b){return document.createElement(b)},z=function(b,a){return null==b?!1:0==b.trim().toLowerCase().indexOf(a)},Oi=function(b,a){if(null!=b)return b=b.trim(),b.lastIndexOf(a)===b.length-1},Li=function(b){void 0==dh&&(dh=p("textarea"));dh.innerHTML=b;return dh.value},ii=function(b,a,c){var d=p("select");d.style.width="70px";d.style.margin="5px";for(var g=0;g<b.length;g++){var e=
p("option");e.innerHTML=b[g];e.value=a[g];d.add(e)}d.addEventListener("change",c,!1);return d},Ki=function(b){b=b.split(",");O=Array(t);for(var a=0;a<b.length;a++){var c=b[a].split("&");Y=b.length;for(var d=0;d<t;d++)0===a&&(O[d]=Array(Y)),O[d][a]=c[1==c.length?0:d].trim(),null!=vb?O[d][a]=(vb+O[d][a]).trim():null!=ia&&(O[d][a]=(ia+O[d][a]).trim())}sd=!1},Ii=function(b){b=b.split(",");t=b.length;ya=Array(t);for(var a=0;a<t;a++)ya[a]=null!=ia?ia+b[a].trim():b[a].trim();sd=!1;t>Y&&(Y=0)},Ji=function(b,
a,c){var d=b;null!=ia&&(d=ia+b);ya=Array(t);for(var g=0;g<t;g++){b=g*c+a;if(0<=d.indexOf("*"))ya[g]=d.replace("*",b);else if(0<=d.indexOf("?")){for(var f=d;0<=f.lastIndexOf("?");){var h=f.lastIndexOf("?");f=f.substring(0,h)+b%10+f.substring(h+1);b=Math.floor(b/10)}ya[g]=f}else ya[g]=d+g;ha("image filename = "+ya[g])}z(e.reverse_order,"t")&&ya.reverse();sd=!1;t>Y&&(Y=0)};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(b,a,c){c=window.atob(this.toDataURL(a,
c).split(",")[1]);for(var d=c.length,g=new Uint8Array(d),e=0;e<d;e++)g[e]=c.charCodeAt(e);b(new Blob([g],{type:a||"image/png"}))}});this.setup=function(b,a,g,d){void 0==a&&(a="MORdivcan");sf=a;re=g;void 0!=re&&"function"!=typeof re&&(re=null);gh=void 0!=d?d.split("\n"):null;u=document.getElementById(a);be="center";u.align=be;Wa=p("div");Wa.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
sb=p("canvas");sb.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");D=sb.getContext("2d");zc=p("canvas");zc.setAttribute("style","position:absolute;top:0;left:0;z-index:12;");k=zc.getContext("2d");k.imageSmoothingEnabled=!1;ne=p("canvas");ne.setAttribute("style","position:absolute;top:0;left:0;z-index:10;");Cg=ne.getContext("2d");Cg.imageSmoothingEnabled=!1;Gc=p("div");Gc.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;border-width:0px;padding:0px;margin:0px;");
qe=p("div");qe.setAttribute("style","position:absolute;top:0;left:0;z-index:10;overflow:hidden;border-width:0px;padding:0px;margin:0px;");qe.appendChild(ne);hf=p("canvas");Wa.appendChild(qe);Wa.appendChild(sb);Wa.appendChild(zc);Wa.appendChild(Gc);u.appendChild(Wa);oa=new PEvs(Wa,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);u.setAttribute("tabindex",0);u.addEventListener("keyup",function(a){Rb||Ne||(Eg=Fg=uf=!1,Qe&&(a.preventDefault(),a.stopPropagation()))},!1);u.addEventListener("keypress",
function(a){Rb||Ne||!Qe||(a.preventDefault(),a.stopPropagation())},!1);u.addEventListener("keydown",function(a){Rb||Ne||(Qe&&(a.preventDefault(),a.stopPropagation()),uf=a.ctrlKey?!0:!1,Fg=a.shiftKey?!0:!1,Eg=a.altKey?!0:!1,37==a.keyCode?(F(!1),rb(-1),U()):39==a.keyCode?(F(!1),rb(1),U()):32==a.keyCode?HAniS.toggleIsLooping():82==a.keyCode&&a.altKey&&HAniS.resetZoom())},!1);u.addEventListener("mouseenter",function(a){u.focus({preventScroll:!0})},!1);u.style.outlineWidth="0px";u.style.outline="none";
Vb=.01745329252;Lb=m=0;Fe=!1;we=1;Ff=Cb=!1;za=Da=!0;Lf=!1;eb=Y=t=0;Yf=We=!1;Xe=!0;Sc=null;hb=[];cd=!1;Ea=0;md=[];Fc=!0;Ga=500;gc=100;Wc=2E3;og=30;lh=0;Xf=6E4;Pc=null;Uc=ee=!1;af=!0;Hc=[];Bd=vb=ia=null;xg=!1;ta=Fh=null;Sd=!1;ca=-1;Hd=!1;Cf=pf=K=C=1;Of=!1;J=G=Ha=Ia=ka=ja=A=n=W=Z=0;Th=!1;Jd=bi=!0;Ng=Rf=fe=!1;ge=eh=-1;Za=[];Ab=0;Pg=!1;pa=null;ad=-1;rg=0;Ee=!1;Ua=null;lf=kf=Sa=mc=0;Zh=!1;X=0;Nb=hg=ig=fd=!1;Zg=$g=If=Jf=0;gd=ac=!1;Ma=[];Ma.push("default");Ma.push("default");Tf="default";Nd=!1;Ue="default";
kc=null;Ba=[0,0];Wd=[0,0];pb=zg=Se=!1;xd=!0;va=Bc=null;Db=Xg=!1;df=!0;Uf="default";ye=!0;ua=[];bc=Wf=!1;Ve="default";Yc=!1;Ai=[1,0,0];Bi=[2,2,1];vc=[];Ac=[];Rc=Kd=jb=!1;$e=Df=0;Tb=tf=rf=y=Eb=null;Og=0;Qe=!0;Rb=Ne=Fg=Eg=uf=!1;Id=27;a=p("canvas");a.height=1;a.width=1;ab=a.getContext("2d");ab.imageSmoothingEnabled=!1;Bg=p("canvas");Me=!1;"string"===typeof b?0>b.indexOf("\n")?Gb(b):c(b.split("\n")):c(b)};this.newBasenames=function(b,a,c,d){fd=!1;za=Da;F(!1);t=d;Ji(b,a,c);Fc=!0;Wb()};this.newFilenames=
function(b){fd=!1;za=Da;F(!1);Ii(b);Fc=!0;Wb()};this.newOverlayFilenames=function(b){fd=!1;za=Da;F(!1);Ki(b);Fc=!0;Wb()};this.newProbeTable=function(b){Yc=!1;q(b.trim())};this.reloadFOF=function(){ha("reload FoF = "+Pc);wc("r");sd?dj(cj,!1):(za=null==qf?!0:Da,Fc=!0,Wb())};this.getFOF=function(){var b=e.file_of_filenames.trim();HAniS.newFOF(null!=Bd?Bd+b:b,!0)};this.newFOF=function(b,a){HAniS.resetZoom();dj(b,a)};var dj=function(b,a){var c,d,e,f,h=new XMLHttpRequest,l,k,p,r,m,v,n,w=null,z=!1;ai=Ab;
fd=!1;za=Da;F(!1);a&&wa(Lb);Ab=t=0;ya=[];V=Ya=null;xg=!1;yg=[];for(me=null;Gc.hasChildNodes();)Gc.removeChild(Gc.lastChild);of=0;Sd=pb=Ld=!1;Aa=ed=oc=null;Ta=[];Lc=-1;O=[];var y=!1;if(null==wb||null!=ke)wb=[];ha("new FOF="+b);jb&&(null!=pc&&(L(pc,!0,"extrap on"),u.style.cursor="default",F(za),$a=-1),jb=!1,fa());Db&&(null!=hd&&(L(hd,!0,"mark on"),u.style.cursor="default",F(za),Pd=-1),Db=!1,fa());h.onload=function(){var a=this.responseText.split("\n");for(c=0;c<a.length;c++)if(!(2>a[c].length)&&(l=
a[c].trim(),ha("FOF: "+l),0!=l.indexOf("#")))if(0==l.indexOf("frame_labels"))m=l.split("="),gb=m[1].split(",");else if(0==l.indexOf("redirect"))for(m=l.split("="),n=m[1].split(","),me=n[0].trim(),d=1;d<n.length;d++){var b=parseInt(n[d],10)-1;yg[b]=!0}else if(0==l.indexOf("framenumber_index_values"))m=l.split("="),cg=m[1].split(",");else if(0==l.indexOf("slice")){m=l.split("=");n=m[1].split(",");V=[];for(d=0;d<n.length;d++)V[d]=parseInt(n[d],10);V[2]=V[2]-V[0]+1;V[3]=V[3]-V[1]+1;4<V.length&&(V[6]=
V[6]-V[4]+1,V[7]=V[7]-V[5]+1)}else if(0==l.indexOf("fof_extension"))m=l.split("="),w=m[1].trim();else if(0==l.indexOf("probe_table"))m=l.split("="),Yc=!1,q(m[1].trim());else if(0==l.indexOf("image_base"))m=l.split("="),ia=m[1].trim();else if(0==l.indexOf("overlay_base"))m=l.split("="),vb=m[1].trim();else if(0==l.indexOf("high_res_basemap")){m=l.split("=");n=m[1].split(",");ed=[];for(d=0;d<n.length;d++)ed[d]=n[d].trim(),null!=ia&&(ed[d]=ia+ed[d]);Sd=!0}else if(0==l.indexOf("high_res_overlay"))for(m=
l.split("="),v=m[1].split("&"),e=0;e<v.length;e++){n=v[e].split(",");Lc=parseInt(n[0].trim(),10)-1;Ta[Lc]=[];for(d=1;d<n.length;d++)Ta[Lc][d-1]=n[d].trim(),Oi(Ta[Lc][d-1],"/")||(null!=vb?Ta[Lc][d-1]=vb+Ta[Lc][d-1]:null!=ia&&(Ta[Lc][d-1]=ia+Ta[Lc][d-1]));Sd=!0}else if(0==l.indexOf("high_res_zoom")){m=l.split("=");n=m[1].split(",");ta=[];for(d=0;d<n.length;d++)ta[d]=parseFloat(n[d].trim());Zb()}else if(0==l.indexOf("hoverzone"))Yd(l);else if(0==l.indexOf("hotzone"))Oa(l);else if(0==l.indexOf("hotspot"))z||
(fb=null,eb=0,z=!0),Xb(l);else if(0==l.indexOf("toggle_onoff"))m=l.split("="),Af=m[1].split(",");else if(0==l.indexOf("coordinates"))m=l.split("="),E(m[1]);else if(0==l.indexOf("fof_substitute"))b=l.indexOf("="),n=l.substring(b+1).split(","),xg=!0,$h=n[0].trim(),Ni=n[1].trim();else if(0==l.indexOf("map_scale"))m=l.split("="),n=m[1].split(","),Oc=parseFloat(n[0]),Re=1<n.length?parseFloat(n[1]):Oc;else if(0==l.indexOf("times")){m=l.split("=");n=m[1].split(",");for(c=0;c<n.length;c++)wb[c]=parseInt(n[c].trim(),
10);y=!0}else{null!=ke&&(b=l.match(ke),null!=b&&2==b.length?(wb.push(parseInt(b[1],10)),ha("+ + + Extrap time = "+b[1]),y=!0):ha("+ + + Cannot parse times using "+ke+" from line: "+l));e=l.indexOf(" ");0>e&&(e=l.length);ya[t]=l.substring(0,e).trim();null!=ia&&(ya[t]=ia+ya[t]);l=l.substring(e+1);b=l.indexOf('"');0<=b&&(null==gb&&(gb=[]),e=l.substring(b+1),b=e.indexOf('"'),0<=b&&(gb[t]=e.substring(0,b),0==t&&(Ua.innerHTML=gb[0])));O[t]=[];b=l.indexOf("overlay");if(0<=b)for(k=l.substring(b),b=k.indexOf("="),
0>b&&ha("Cannot find a = sign in "+k),p=k.substring(b+1),k=p.trim(),p=k.split(","),Y=Math.max(Y,p.length),ha("numOverlays set to "+Y),f=0;f<p.length;f++)O[t][f]=p[f].trim(),null!=me&&yg[f]?O[t][f]=(me+O[t][f]).trim():null!=vb?O[t][f]=(vb+O[t][f]).trim():null!=ia&&(O[t][f]=(ia+O[t][f]).trim());t+=1}y&&aa(wb);null!=w?(a=new XMLHttpRequest,a.onload=function(){var a=this.responseText.split("\n");for(c=0;c<a.length;c++)2>a[c].length||(r=a[c].trim(),ha("ext_FOF: "+r),0!=r.indexOf("#")&&(0==r.indexOf("hotzone")?
Oa(r):0==r.indexOf("hotspot")&&Xb(r)));ma()},a.onerror=function(){ma()},a.open("get",w+"?"+Math.round(1E5*Math.random()),!0),a.send()):ma()};cj=b;h.open("get",b+"?"+Math.round(1E5*Math.random()),!0);h.send()};this.setWindowSize=function(b,a){if(null!=u){u.style.height=a+"px";u.style.width=b+"px";u.style.padding="0px";aj=a=a-(null!=rf?rf.offsetHeight:0)-(null!=tf?tf.offsetHeight:0)-(null!=Eb?Eb.offsetHeight:0)-Og*(null!=Tb?Tb.offsetHeight:0);bj=b;var c=a*qa/ra;c>b&&(c=b,a=b*ra/qa);a=Math.floor(a);
c=Math.floor(c);Jd||(fe?qd(bj,aj):qd(c,a),fa())}};this.drag=function(b){Db||(Z=oa.getX(),W=oa.getY(),Rb?(b=r.length-1,r[b].xe=Z,r[b].ye=W,r[b].xp.push(Z),r[b].yp.push(W),r[b].size=Math.round(Math.sqrt(Math.pow(Z-r[b].x,2)+Math.pow(W-r[b].y,2)))):(n=Z*H,A=W*I,gd=Nb=!1,ac&&(!Se||Se&&b.shiftKey)?(If=n,Jf=A,gd=!0):(Fa&&K!=Cf?(G=ja-n/C,J=ka-A/K,Mc(),ja=Math.round(G+n/C),ka=Math.round(J+A/K),void 0!=Td&&Td(["drag",C,K,ja,ka,n,A,G,J,Ia,Ha])):Db||jb||!pb||(va=null,xd&&0<=n&&0<=A&&(ba=se.getImageData(n,A,
1,1).data,0!=ba[3]&&(va=Ya[ba[3]-1]))),Of=!0,U())),fa())};this.resetZoom=function(){C=pf;K=Cf;ca=-1;null!=Ka&&(L(Ka,!0,"zoom on"),Fa=!1);ja=n;ka=A;J=G=0;Ha=ra;Ia=qa;Zb();U();Ld&&(pb=!0);void 0!=Td&&Td(["reset",0,0])};this.canTip=function(){var b;Nb=!1;Z=oa.getX();n=Z*H;W=oa.getY();A=W*I;if(!((Db||jb)&&A<vi&&A>ui&&n>ti)){ja=Math.round(G+n/C);ka=Math.round(J+A/K);if(0!=Ab)for(b=0;b<Ab;b++)if(Qa[b].overlay>=Y)ha(" Error...hotzone overlay # "+Qa[b].overlay+" > number of overlays = "+Y);else if(w[Qa[b].overlay].checked&&
(ab.clearRect(0,0,1,1),ab.drawImage(N[m][Qa[b].overlay],ja,ka,1,1,0,0,1,1),ba=ab.getImageData(0,0,1,1).data,fh=(ba[0]<<16)+(ba[1]<<8)+ba[2],fh==Qa[b].color)){Nb=!0;wi=Z;xi=W;yi=Qa[b].tip;break}if(0!=eb)for(b=eb-1;0<=b;b--)if(null!=fb[b]){var a=fb[b];if(-1==a.frame||a.frame==m)if(-1==a.overlay||w[a.overlay].checked){var c=!1;if(a.isPan)if(a.isIcon){var d=(a.x0-G)*C-a.w2;var e=(a.y0-J)*K-a.h2;n>d&&n<d+a.width&&A>e&&A<e+a.height&&(c=!0)}else d=(a.x0-G)*C,e=(a.y0-J)*K,n>d&&n<d+a.width*C&&A>e&&A<e+a.height*
K&&(c=!0);else n>a.x0&&n<a.x1&&A>a.y0&&A<a.y1&&(c=!0);if(c&&null!=a.tip){Nb=!0;wi=Z;xi=W;yi=fb[b].tip;break}}}fa()}};this.move=function(){if(!jb&&pb&&(va=null,xd)){var b=oa.getX()*H,a=oa.getY()*I;0<=b&&0<=a&&(ba=se.getImageData(b,a,1,1).data,0!=ba[3]&&(va=Ya[ba[3]-1]))}jb&&2<=$a&&(Z=oa.getX(),n=Z*H,W=oa.getY(),A=W*I);fa()};this.down=function(){Nb&&(Nb=!1,fa());Z=oa.getX();n=Z*H;W=oa.getY();A=W*I;Zg=n;$g=A;If=Zg;Jf=$g;ja=Math.round(G+n/C);ka=Math.round(J+A/K);ac&&(qb(),Wd[0]=Ba[0],Wd[1]=Ba[1]);Of=
!1;if(Rb){var b={};b.x=Z;b.y=W;b.xe=Z;b.ye=W;b.xp=[Z];b.yp=[W];b.type=De.value;b.color=Ce.value;b.width=Kc.value;b.text=Sb.value;b.size=0;r.push(b)}};this.up=function(b){Nb=!1;if(!Rb){if(jb||Db){Z=oa.getX();n=Z*H;W=oa.getY();A=W*I;if(Db){Pd=1;if(0<Pd&&A/I<Zi){if(n/H>Yi){ua.pop();ua.pop();0==ua.length&&(Pd=0);fa();return}if(n/H<Xi){fa();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var a=[],c=0;c<ua.length;c+=2)ja=G+ua[c]/C,ka=J+ua[c+1]/K,qb(),b.document.write(Ba[0].toFixed(4)+
","+Ba[1].toFixed(4)+"<br>"),0==c&&(a[0]=Ba[0],a[1]=Ba[1]);df&&b.document.write(a[0].toFixed(4)+","+a[1].toFixed(4)+"<br>");return}}ua.push(n);ua.push(A);fa();return}if(3>$a)if(Ub[$a]=n,Fb[$a]=A,Ud[$a]=wg[m],0==$a)$a=1,wa(na(t-1)),Df=1,Ad=null;else{Ei=Ud[1]-Ud[0];Hf=(Ub[1]-Ub[0])/Ei;He=(Fb[1]-Fb[0])/Ei;if(null!=fg&&null!=Oc){c=Hf*Oc;var d=He*Re;a=Math.round(60*Math.sqrt(c*c+d*d));c=Math.atan2(c,-d)/Vb;0>c&&(c+=360);Ad=Ch+ij[Math.round(c/22.5)]+" at "+a+" "+Dh;Vi=Ub[0];Wi=0<He?Fb[0]-15:Fb[0]+30}a=
parseInt(ie,10);da=Math.round(Math.abs(4*(a+4)/Hf));Vd=Math.round(Math.abs(2*(a+4)/He));Vd<da&&(da=Vd);120<da?da=120*Math.floor(da/120)+60:90<da?da=120:60<da?da=90:30<da?da=60:15<da?da=30:10<da?da=15:5<da?da=10:2<da?da=5:0==da&&(da=1);Vd=Ud[1]/da*da+da;Ge=1;Bh&&(Ge=-1);si=Hf*da;Yg=He*da;wa(na(t-1));$a=3;Df=2}else if(A/I<vi&&A/I>ui&&n/H>ti&&3==$a){$b();fa();return}fa()}if(gd)gd=!1,fa();else if(null!=qc&&Fa&&(ac=!1,L(qc,!0,"distance on")),Of)Of=!1;else if(b.altKey)HAniS.resetZoom();else if(pb&&null!=
va&&Xg)rd(va,"z");else{Z=oa.getX();n=Z*H;W=oa.getY();A=W*I;if(0!=Ab)for(a=0;a<Ab;a++)if(Qa[a].overlay>=Y)ha(" Error...hotzone overlay # "+Qa[a].overlay+" > number of overlays = "+Y);else if(w[Qa[a].overlay].checked&&(ab.clearRect(0,0,1,1),ab.drawImage(N[m][Qa[a].overlay],Math.floor(ja),Math.floor(ka),1,1,0,0,1,1),ba=ab.getImageData(0,0,1,1).data,fh=(ba[0]<<16)+(ba[1]<<8)+ba[2],fh==Qa[a].color)){rd(Qa[a],"z");return}if(0!=eb)for(a=eb-1;0<=a;a--)if(null!=fb[a]){var e=fb[a];if(!(-1!=e.frame&&e.frame!=
m||e.fromfile||-1!=e.overlay&&!w[e.overlay].checked)){var f=!1;e.isPan?e.isIcon?(c=(e.x0-G)*C-e.w2,d=(e.y0-J)*K-e.h2,n>c&&n<c+e.width&&A>d&&A<d+e.height&&(f=!0)):(c=(e.x0-G)*C,d=(e.y0-J)*K,n>c&&n<c+e.width*C&&A>d&&A<d+e.height*K&&(f=!0)):n>e.x0&&n<e.x1&&A>e.y0&&A<e.y1&&(f=!0);if(f){rd(fb[a],"s");return}}}Fa&&(pb=!1,Zd(b.ctrlKey||uf||b.which&&3==b.which||b.button&&2==b.button));U();fa()}}};this.wheel=function(b){Qh?rb(b):Fa&&(Z=oa.getX(),n=Z*H,W=oa.getY(),A=W*I,ja=Math.round(G+n/C),ka=Math.round(J+
A/K),Zd(-1==b))};this.toggleAutoRefresh=function(){ee?(L(Xc,!1,"autorefresh off"),null!=Pc&&clearInterval(Pc),ee=!1):(L(Xc,!0,"autorefresh on"),Pc=setInterval("HAniS.reloadFOF();",Xf),ee=!0)};this.toggleLoopRock=function(){Fe?(L(ve,!0,"looprock rock"),Fe=!1):(L(ve,!1,"looprock loop"),Fe=!0)};this.toggleLoopHalt=function(){Cb?(L(xe,!0,"loophalt halt"),Ff=Cb=!1):(L(xe,!1,"loophalt loop"),Ff=Cb=!0)};this.toggleExtrap=function(){jb?(null!=pc&&(L(pc,!0,"extrap on"),u.style.cursor=Ma.pop(),null!=Kb&&(Kb.disabled=
!1),F(za),Fa=Rh,$a=-1),jb=!1,fa()):(null!=pc&&(jb=!0,Ad=null,Ma.push(u.style.cursor),u.style.cursor="crosshair",L(pc,!1,"extrap off"),za=Da,null!=Kb&&(Kb.disabled=!0),Da=!1,Rh=Fa,Fa=!1,HAniS.resetZoom(),$b(),fa()),U())};this.doEnhance=function(b){if(Kd||Rc){var a=Xa[0].height,c=Xa[0].width;b=parseInt(Ca.value,10);0<=b?(Rg=bb[b],Sg=cb[b],Tg=db[b],Ug=le[b],Ac[tb]=b):Ac[tb]=null;var d=a*c*4;for(c=0;c<nc.length;c++)if(Xa[c].gotit){Xa[c].gotit=!1;var e=nf[c].data;var f=Ag[c];if(0>b)for(a=0;a<d;a+=4)e[a]=
f[a],e[a+1]=f[a+1],e[a+2]=f[a+2],e[a+3]=f[a+3];else for(a=0;a<d;a+=4)ib=f[a],ib===f[a+1]&&ib===f[a+2]&&(e[a]=Rg[ib],e[a+1]=Sg[ib],e[a+2]=Tg[ib],e[a+3]=Ug[ib]);dd[c].putImageData(nf[c],0,0);Xa[c].gotit=!0}}};this.overClick=function(b){var a;if(b.target.checked)for(a=0;a<w.length;a++)b.target!=w[a]&&0!=b.target.name&&b.target.name==w[a].name&&(w[a].checked=!1);xd=!0;for(a=0;a<fc.length;a++)b.target!=w[a]&&Ib(a),null!=Bc&&!Bc[a]&&w[a].checked&&(xd=!1),null!=Ca&&a===tb&&(Ca.disabled=!w[a].checked);U()};
this.toggleIsLooping=function(){Da?(Da=!1,L(Kb,!0,"startstop start")):(Da=!0,L(Kb,!1,"startstop stop"),Ff=Cb,Cb=!1)};this.toggleZooming=function(){Fa?(HAniS.resetZoom(),L(Ka,!0,"zoom on")):(L(Ka,!1,"zoom off"),Fa=!0,null!=qc&&(ac=!1,L(qc,!0,"distance on")),Ld&&(pb=!0),jb&&HAniS.toggleExtrap())};this.togup=function(b){eh=-1};this.togdown=function(b){var a=Lg.getX();Lg.getY();for(var c=qi,d=0;d<Za.length;d++){if(a>c&&a<c+Rd){if(d==eh)break;if(b.shiftKey){0<=Za[d]&&(F(!1),wa(d));break}a=0;!b.ctrlKey&&
0<=Za[d]&&(a=-1);Ja(d,a);eh=d;break}c=c+Rd+zf}};this.makeMP4=function(){var b=Mb.innerHTML;za=Da;F(!1);we=1;wa(na(Lb));Mb.innerHTML="Working";HME.createH264MP4Encoder().then(function(a){var c,d,f,h,k;return $jscomp.asyncExecutePromiseGeneratorProgram(function(g){switch(g.nextAddress){case 1:a.width=M,a.height=P,a.frameRate=Math.max(1,Math.round(1E3/Ga)),a.quantizationParameter=Id,a.initialize();case 2:return U(),a.addFrameRgba(D.getImageData(0,0,M,P).data),g.yield(new Promise(function(a){return window.requestAnimationFrame(a)}),
4);case 4:if(m>=na(t-1)){g.jumpTo(3);break}rb(1);g.jumpTo(2);break;case 3:a.finalize();Mb.innerHTML=b;c=a.FS.readFile(a.outputFilename);d=e.mp4_prompt;f=e.mp4_filename;null==f&&(f="hanimate.mp4");h=f;if(null!=d&&(h=window.prompt(d,h),null==h))return a.delete(),F(za),g.return();k=document.createElement("a");k.href=URL.createObjectURL(new Blob([c],{type:"video/mp4"}));k.download=h;k.click();a.delete();F(za);g.jumpToEnd()}})})};this.makeAniGIF=function(){if(!Lf){var b=Bb.innerHTML;Mf=new GIF({workers:4,
debug:!1,quality:10,width:M,height:P,repeat:0});Mf.on("finished",function(a){Bb.innerHTML=b;var c=e.anigif_prompt,d=e.anigif_filename;null==d&&(d="hanimate.gif");if(null!=c&&(d=window.prompt(c,d),null==d))return;c=document.createElement("a");c.href=URL.createObjectURL(a);c.download=d;c.click();setTimeout(function(){URL.revokeObjectURL(a)},3E4)});Mf.on("progress",function(a){Bb.innerHTML=Math.round(100*a)+"%"});za=Da;F(!1);we=1;Lf=!0;wa(na(Lb));U();F(!0);Bb.innerHTML="Loading"}};this.doneLoading=function(b){mf=
b};this.getCustomButton=function(){return ff};this.dwellChanged=function(b){Qd=b};this.getDwell=function(){return Ga};this.frameChanged=function(b){Ef=b};this.getFrame=function(){return m};this.showFrame=function(b){wa(na(b));U()};this.zoomChanged=function(b){Td=b};this.showZoom=function(b){"reset"===b[0]?HAniS.resetZoom():(C=b[1],K=b[2],ja=b[3],ka=b[4],n=b[5],A=b[6],G=b[7],J=b[8],Ia=b[9],Ha=b[10],Mc(),U())}};
